(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d2ef58d"],{"0b56":function(t,e,a){"use strict";a.r(e);a("b680"),a("a9e3");var o=function(){var t=this,e=t._self._c;return e("page-header-wrapper",{attrs:{breadcrumb:!1}},[e("div",{staticStyle:{"padding-bottom":"20px"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:6}},[e("a-card",{attrs:{hoverable:"",bordered:!1}},[e("a-statistic",{staticClass:"demo-class",attrs:{title:"总CPU使用情况",value:" "+Number(t.useCPU/t.totalCPU).toFixed(2)+"%","value-style":{color:"#1890ff",fontSize:"29px"}},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("a-icon",{attrs:{type:"rocket",theme:"twoTone"}})]},proxy:!0}])})],1)],1),e("a-col",{attrs:{span:6}},[e("a-card",{attrs:{hoverable:"",bordered:!1}},[e("a-statistic",{staticClass:"demo-class",attrs:{title:"总内存使用情况",value:" "+Number(t.useMem).toFixed(2)+"M","value-style":{color:"#1890ff",fontSize:"29px"}},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("a-icon",{attrs:{type:"thunderbolt",theme:"twoTone"}})]},proxy:!0}])})],1)],1),e("a-col",{attrs:{span:6}},[e("a-card",{attrs:{hoverable:"",bordered:!1},on:{click:function(e){return t.$router.push({name:"resourceList"})}}},[e("a-statistic",{staticClass:"demo-class",attrs:{title:"总资源数量",value:" "+t.systemStatistics.resourceCount,"value-style":{color:"#1890ff",fontSize:"29px"}},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("a-icon",{attrs:{type:"appstore",theme:"twoTone"}})]},proxy:!0}])})],1)],1),e("a-col",{attrs:{span:6}},[e("a-card",{attrs:{hoverable:"",bordered:!1},on:{click:function(e){return t.$router.push({name:"ruleList"})}}},[e("a-statistic",{staticClass:"demo-class",attrs:{title:"总规则数量",value:" "+t.systemStatistics.ruleCount,"value-style":{color:"#1890ff",fontSize:"29px"}},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("a-icon",{attrs:{type:"api",theme:"twoTone"}})]},proxy:!0}])})],1)],1)],1)],1),e("a-card",{attrs:{"body-style":{paddingTop:"10px"},bordered:!1}},[e("a-tabs",{attrs:{"default-active-key":"1"},model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[e("a-tab-pane",{key:"1",attrs:{tab:"基本信息"}},[e("SystemInfo",{ref:"systemInfo",attrs:{nodeUrl:t.node}})],1),e("a-tab-pane",{key:"2",attrs:{tab:"JVM信息"}},[e("JvmInfo",{ref:"jvmInfo",attrs:{nodeUrl:t.node}})],1),e("a-tab-pane",{key:"3",attrs:{tab:"磁盘信息"}},[e("DiskInfo",{ref:"diskInfo"})],1)],1)],1)],1)},r=[],n=a("c1df"),s=a.n(n),c=a("8593"),u=a("0fea"),i=function(){var t=this,e=t._self._c;return e("a-skeleton",{attrs:{active:"",loading:t.loading,paragraph:{rows:17}}},[e("a-table",{staticStyle:{"margin-top":"20px"},attrs:{rowKey:"id",size:"middle",columns:t.columns,dataSource:t.dataSource,pagination:!1,loading:t.tableLoading},scopedSlots:t._u([{key:"param",fn:function(a,o){return[e("a-tag",{attrs:{color:t.textInfo[o.param].color}},[t._v(t._s(a))])]}},{key:"text",fn:function(e,a){return[t._v(" "+t._s(t.textInfo[a.param].text)+" ")]}},{key:"value",fn:function(e,a){return[t._v(" "+t._s(e)+" "+t._s(t.textInfo[a.param].unit)+" ")]}}])})],1)},m=[];a("d3b7"),a("3ca3"),a("ddb0"),a("159b"),a("b0c0");s.a.locale("zh-cn");var l={props:{nodeUrl:{type:String,default:""}},data:function(){return{time:"",loading:!0,tableLoading:!0,columns:[{title:"参数",width:"30%",dataIndex:"param",scopedSlots:{customRender:"param"}},{title:"描述",width:"40%",dataIndex:"text",scopedSlots:{customRender:"text"}},{title:"当前值",width:"30%",dataIndex:"value",scopedSlots:{customRender:"value"}}],dataSource:[],textInfo:{"jvm.memory.max":{color:"purple",text:"JVM 最大内存",unit:"MB"},"jvm.memory.committed":{color:"purple",text:"JVM 可用内存",unit:"MB"},"jvm.memory.used":{color:"purple",text:"JVM 已用内存",unit:"MB"},"jvm.buffer.memory.used":{color:"cyan",text:"JVM 缓冲区已用内存",unit:"MB"},"jvm.buffer.count":{color:"cyan",text:"当前缓冲区数量",unit:"个"},"jvm.threads.daemon":{color:"green",text:"JVM 守护线程数量",unit:"个"},"jvm.threads.live":{color:"green",text:"JVM 当前活跃线程数量",unit:"个"},"jvm.threads.peak":{color:"green",text:"JVM 峰值线程数量",unit:"个"},"jvm.classes.loaded":{color:"orange",text:"JVM 已加载 Class 数量",unit:"个"},"jvm.classes.unloaded":{color:"orange",text:"JVM 未加载 Class 数量",unit:"个"},"jvm.gc.memory.allocated":{color:"pink",text:"GC 时, 年轻代分配的内存空间",unit:"MB"},"jvm.gc.memory.promoted":{color:"pink",text:"GC 时, 老年代分配的内存空间",unit:"MB"},"jvm.gc.max.data.size":{color:"pink",text:"GC 时, 老年代的最大内存空间",unit:"MB"},"jvm.gc.live.data.size":{color:"pink",text:"FullGC 时, 老年代的内存空间",unit:"MB"},"jvm.gc.pause.count":{color:"blue",text:"系统启动以来GC 次数",unit:"次"},"jvm.gc.pause.totalTime":{color:"blue",text:"系统启动以来GC 总耗时",unit:"秒"}},moreInfo:{"jvm.gc.pause":[".count",".totalTime"]}}},mounted:function(){this.loadJvmInfo()},methods:{handleClickUpdate:function(){this.loadJvmInfo()},loadJvmInfo:function(){var t=this;this.tableLoading=!0,this.time=s()().format("YYYY年MM月DD日 HH时mm分ss秒"),Promise.all([Object(u["b"])("/actuator/metrics/jvm.memory.max"),Object(u["b"])("/actuator/metrics/jvm.memory.committed"),Object(u["b"])("/actuator/metrics/jvm.memory.used"),Object(u["b"])("/actuator/metrics/jvm.buffer.memory.used"),Object(u["b"])("/actuator/metrics/jvm.buffer.count"),Object(u["b"])("/actuator/metrics/jvm.threads.daemon"),Object(u["b"])("/actuator/metrics/jvm.threads.live"),Object(u["b"])("/actuator/metrics/jvm.threads.peak"),Object(u["b"])("/actuator/metrics/jvm.classes.loaded"),Object(u["b"])("/actuator/metrics/jvm.classes.unloaded"),Object(u["b"])("/actuator/metrics/jvm.gc.memory.allocated"),Object(u["b"])("/actuator/metrics/jvm.gc.memory.promoted"),Object(u["b"])("/actuator/metrics/jvm.gc.max.data.size"),Object(u["b"])("/actuator/metrics/jvm.gc.live.data.size"),Object(u["b"])("/actuator/metrics/jvm.gc.pause")]).then((function(e){var a=[];e.forEach((function(e,o){var r=t.moreInfo[e.name];r instanceof Array||(r=[""]),r.forEach((function(r,n){var s=e.name+r,c=e.measurements[n].value;"jvm.memory.max"!==s&&"jvm.memory.committed"!==s&&"jvm.memory.used"!==s&&"jvm.buffer.memory.used"!==s&&"jvm.gc.memory.allocated"!==s&&"jvm.gc.memory.promoted"!==s&&"jvm.gc.max.data.size"!==s&&"jvm.gc.live.data.size"!==s||(c=t.convert(c,Number)),a.push({id:s+o,param:s,text:"false value",value:c})}))})),t.dataSource=a})).catch((function(e){t.$message.error("获取JVM信息失败")})).finally((function(){t.loading=!1,t.tableLoading=!1}))},convert:function(t,e){return e===Number?Number(t/1048576).toFixed(3):e===Date?s()(1e3*t).format("YYYY-MM-DD HH:mm:ss"):t}}},d=l,f=a("2877"),p=Object(f["a"])(d,i,m,!1,null,null,null),v=p.exports,b=function(){var t=this,e=t._self._c;return e("a-skeleton",{attrs:{active:"",loading:t.loading,paragraph:{rows:17}}},[e("a-table",{staticStyle:{"margin-top":"20px"},attrs:{rowKey:"id",size:"middle",columns:t.columns,dataSource:t.dataSource,pagination:!1,loading:t.tableLoading},scopedSlots:t._u([{key:"param",fn:function(a,o){return[e("a-tag",{attrs:{color:t.textInfo[o.param].color}},[t._v(t._s(a))])]}},{key:"text",fn:function(e,a){return[t._v(" "+t._s(t.textInfo[a.param].text)+" ")]}},{key:"value",fn:function(e,a){return[t._v(" "+t._s(e)+" "+t._s(t.textInfo[a.param].unit)+" ")]}}])})],1)},h=[];s.a.locale("zh-cn");var y={props:{nodeUrl:{type:String,default:""}},data:function(){return{time:"",loading:!0,tableLoading:!0,columns:[{title:"参数",width:"30%",dataIndex:"param",scopedSlots:{customRender:"param"}},{title:"描述",width:"40%",dataIndex:"text",scopedSlots:{customRender:"text"}},{title:"当前值",width:"30%",dataIndex:"value",scopedSlots:{customRender:"value"}}],dataSource:[],textInfo:{"system.cpu.count":{color:"green",text:"CPU 数量",unit:"核"},"system.cpu.usage":{color:"green",text:"系统 CPU 使用率",unit:"%"},"process.start.time":{color:"purple",text:"应用启动时间点",unit:""},"process.uptime":{color:"purple",text:"应用已运行时间",unit:"秒"},"process.cpu.usage":{color:"purple",text:"当前应用 CPU 使用率",unit:"%"}},moreInfo:{}}},mounted:function(){this.loadSystemInfo()},methods:{handleClickUpdate:function(){this.loadSystemInfo()},loadSystemInfo:function(){var t=this;this.tableLoading=!0,this.time=s()().format("YYYY年MM月DD日 HH时mm分ss秒");var e=this.nodeUrl?"http://"+this.nodeUrl:"";Promise.all([Object(u["b"])(e+"/actuator/metrics/system.cpu.count"),Object(u["b"])(e+"/actuator/metrics/system.cpu.usage"),Object(u["b"])(e+"/actuator/metrics/process.start.time"),Object(u["b"])(e+"/actuator/metrics/process.uptime"),Object(u["b"])(e+"/actuator/metrics/process.cpu.usage")]).then((function(e){var a=[];e.forEach((function(e,o){var r=t.moreInfo[e.name];r instanceof Array||(r=[""]),r.forEach((function(r,n){var s=e.name+r,c=e.measurements[n].value;"system.cpu.usage"!==s&&"process.cpu.usage"!==s||(c=t.convert(c,Number)),"process.start.time"===s&&(c=t.convert(c,Date)),a.push({id:s+o,param:s,text:"false value",value:c})}))})),t.dataSource=a})).catch((function(e){t.$message.error("获取服务器信息失败")})).finally((function(){t.loading=!1,t.tableLoading=!1}))},convert:function(t,e){return e===Number?Number(100*t).toFixed(2):e===Date?s()(1e3*t).format("YYYY-MM-DD HH:mm:ss"):t}}},g=y,x=Object(f["a"])(g,b,h,!1,null,null,null),j=x.exports,S=function(){var t=this,e=t._self._c;return e("a-skeleton",{attrs:{active:"",loading:t.loading,paragraph:{rows:17}}},[e("a-table",{staticStyle:{"margin-top":"20px"},attrs:{rowKey:"name",size:"middle",columns:t.columns,dataSource:t.dataSource,pagination:!1,loading:t.tableLoading},scopedSlots:t._u([{key:"value",fn:function(e){return[t._v(" "+t._s(Math.round(e/1024/1024))+" MB ")]}},{key:"progress",fn:function(t,a){return[e("a-progress",{staticStyle:{width:"50%"},attrs:{percent:Math.round((a.total-a.free)/a.total*100),size:"small"}})]}}])})],1)},I=[];s.a.locale("zh-cn");var M={data:function(){return{loading:!0,tableLoading:!0,columns:[{title:"磁盘名称",width:"20%",dataIndex:"name"},{title:"使用情况",width:"40%",dataIndex:"progress",scopedSlots:{customRender:"progress"}},{title:"总空间",width:"20%",dataIndex:"total",scopedSlots:{customRender:"value"}},{title:"可用空间",width:"20%",dataIndex:"free",scopedSlots:{customRender:"value"}}],dataSource:[]}},mounted:function(){this.loadDiskInfo()},methods:{loadDiskInfo:function(){var t=this;this.tableLoading=!0,Object(u["b"])("/api/system/disk",{}).then((function(e){t.dataSource=e.data})).catch((function(e){t.$message.error("获取磁盘信息失败")})).finally((function(){t.loading=!1,t.tableLoading=!1}))}}},k=M,O=Object(f["a"])(k,S,I,!1,null,null,null),C=O.exports,_={name:"Monitor",components:{JvmInfo:v,SystemInfo:j,DiskInfo:C},data:function(){return{dateTime:s()(new Date).format("YYYY-MM-DD"),node:"",nodeList:[],totalCPU:1,useCPU:1,totalJVMMem:1,useMem:1,activeKey:"1",systemStatistics:{resourceCount:0,ruleCount:0},timer:null}},created:function(){},mounted:function(){var t=this;this.getTotalSystemInfo(),this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){t.getTotalSystemInfo()}),1e4)},methods:{nodeSelectChange:function(t){"1"===this.activeKey?this.$refs.systemInfo.loadSystemInfo():"2"===this.activeKey?this.$refs.jvmInfo.loadJvmInfo():"3"===this.activeKey&&this.$refs.diskInfo.loadDiskInfo()},getTotalSystemInfo:function(){var t=this;this.totalCPU=1,this.useCPU=0,this.totalJVMMem=1,this.useMem=0,Object(u["b"])("/actuator/metrics/system.cpu.count").then((function(e){var a=e.measurements[0].value;t.totalCPU+=a,Object(u["b"])("/actuator/metrics/process.cpu.usage").then((function(e){var o=e.measurements[0].value;o=t.convert(o,Number),t.useCPU+=a*o}))})),Object(u["b"])("/actuator/metrics/jvm.memory.max").then((function(e){var a=e.measurements[0].value;a=t.convertMem(a,Number),t.totalJVMMem+=a})),Object(u["b"])("/actuator/metrics/jvm.memory.used").then((function(e){var a=e.measurements[0].value;a=t.convertMem(a,Number),t.useMem=Number(t.useMem)+Number(a)})),Object(c["b"])().then((function(e){t.systemStatistics=e.data}))},convert:function(t,e){return e===Number?Number(100*t).toFixed(2):e===Date?s()(1e3*t).format("YYYY-MM-DD HH:mm:ss"):t},convertMem:function(t,e){return e===Number?Number(t/1048576).toFixed(2):t}}},w=_,Y=(a("d802"),Object(f["a"])(w,o,r,!1,null,null,null));e["default"]=Y.exports},"0fea":function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return n})),a.d(e,"b",(function(){return s})),a.d(e,"a",(function(){return c})),a.d(e,"e",(function(){return u}));var o=a("b775");function r(t,e){return Object(o["b"])({url:t,method:"post",data:e})}function n(t,e){return Object(o["b"])({url:t,method:"put",data:e})}function s(t,e){return Object(o["b"])({url:t,method:"get",params:e})}function c(t,e){return Object(o["b"])({url:t,params:e,method:"get",responseType:"blob"})}function u(t,e){return Object(o["b"])({url:t,method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}},1362:function(t,e,a){},d802:function(t,e,a){"use strict";a("1362")}}]);