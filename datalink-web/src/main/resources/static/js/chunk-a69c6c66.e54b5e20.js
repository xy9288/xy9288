(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a69c6c66"],{"0fea":function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return i}));var n=a("b775");function r(e,t){return Object(n["b"])({url:e,method:"post",data:t})}function o(e,t){return Object(n["b"])({url:e,method:"put",data:t})}function c(e,t){return Object(n["b"])({url:e,method:"get",params:t})}function s(e,t){return Object(n["b"])({url:e,params:t,method:"get",responseType:"blob"})}function i(e,t){return Object(n["b"])({url:e,method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})}},"789f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("page-header-wrapper",{attrs:{breadcrumb:!1}},[t("a-card",{staticStyle:{"margin-bottom":"15px"},attrs:{"body-style":{paddingBottom:0},bordered:!1}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"备份名称"}},[t("a-input",{attrs:{placeholder:"请输入备份名称"},model:{value:e.queryParam.backupName,callback:function(t){e.$set(e.queryParam,"backupName",t)},expression:"queryParam.backupName"}})],1)],1),t("a-col",{attrs:{md:11,sm:24}},[t("a-button",{attrs:{type:"primary"},on:{click:e.loadData}},[e._v("查询")]),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{md:6,sm:24}},[t("a-space",{attrs:{size:"middle"}},[t("a-upload",{attrs:{showUploadList:!1,beforeUpload:e.checkFile,customRequest:e.customRequest},on:{change:e.handlerUpload}},[t("a-button",[t("a-icon",{attrs:{type:"upload"}}),e._v(" 上传并恢复备份 ")],1)],1),t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("创建备份")])],1)],1)],1)],1)],1)]),t("a-card",{attrs:{"body-style":{minHeight:"500px"},bordered:!1}},[t("a-table",{ref:"table",attrs:{columns:e.columns,"data-source":e.dataSource,pagination:!1,loading:e.loading},scopedSlots:e._u([{key:"serial",fn:function(a,n,r){return t("span",{},[e._v(" "+e._s(r+1)+" ")])}},{key:"description",fn:function(a,n,r){return t("span",{},[e._v(" "+e._s(a||"-")+" ")])}},{key:"action",fn:function(a,n){return t("span",{},[[t("a",{on:{click:function(t){return e.recover(n)}}},[e._v("恢复")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.download(n)}}},[e._v("下载")]),t("a-divider",{attrs:{type:"vertical"}}),e.dataSource.length?t("a-popconfirm",{attrs:{title:"删除此备份?"},on:{confirm:function(){return e.handleDelete(n)}}},[t("a",{attrs:{href:"javascript:;"}},[e._v("删除")])]):e._e()]],2)}}])})],1)],1)},r=[],o=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("ac1f"),a("1276"),a("b0c0"),a("0fea")),c={name:"BackupList",components:{},data:function(){return{columns:[{title:"名称",dataIndex:"backupName"},{title:"时间",dataIndex:"createTime"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],dataSource:[],loading:!0,queryParam:{}}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0,Object(o["c"])("/api/backup/list",this.queryParam).then((function(t){e.dataSource=t.data,e.loading=!1}))},handleDelete:function(e){var t=this;Object(o["c"])("/api/backup/remove",e).then((function(e){200===e.code?(t.$message.success("删除成功"),t.loadData()):t.$message.error("删除失败")}))},handleAdd:function(){var e=this;Object(o["c"])("/api/backup/create",{}).then((function(t){200===t.code?(e.$message.success("创建成功"),e.loadData()):e.$message.error("创建失败")}))},download:function(e){Object(o["a"])("/api/backup/download",{backupName:e.backupName}).then((function(t){var a=new Blob([t]),n=document.createElement("a"),r=window.URL.createObjectURL(a);n.href=r,n.download=decodeURIComponent(e.backupName),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}))},recover:function(e){var t=this;this.$confirm({title:"恢复此备份数据?",content:"此操作将导致现有数据丢失",onOk:function(){Object(o["b"])("/api/backup/recover",{backupName:e.backupName}).then((function(e){200===e.code?(t.$message.success("恢复成功"),t.loadData()):t.$message.error("恢复失败")}))}})},reset:function(){this.queryParam={},this.loadData()},checkFile:function(e){var t=e.size/1024/1024<100;if(!t)return this.$message.error("文件大小不能超过100M！"),!1;var a=["json"],n=e.name.split(".").pop();return n&&(n=n.toLowerCase()),-1!==a.indexOf(n)||(this.$message.error("文件格式不合法！"),!1)},handlerUpload:function(e){e.file.status,"done"===e.file.status?200===e.file.response.code?this.$message.success("".concat(e.file.name," 上传成功")):this.$message.error("上传出错,".concat(e.file.response.message)):"error"===e.file.status&&this.$message.error("上传出错")},customRequest:function(e){var t=new FormData;t.append("file",e.file),Object(o["e"])("/api/backup/upload",t).then((function(t){e.onSuccess(t,e.file)}))}}},s=c,i=a("2877"),u=Object(i["a"])(s,n,r,!1,null,null,null);t["default"]=u.exports}}]);