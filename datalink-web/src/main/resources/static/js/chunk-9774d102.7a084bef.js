(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9774d102"],{"1e0e":function(t,e,a){"use strict";a.r(e);a("a4d3"),a("e01a"),a("b0c0");var s=function(){var t=this,e=t._self._c;return e("div",[e("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1,"body-style":{padding:"17px 24px"}}},[e("a-row",[e("a-col",{staticStyle:{"font-size":"16px","font-weight":"bold",color:"rgba(0, 0, 0, 0.85)","padding-top":"4px"},attrs:{span:12}},[t._v(" "+t._s(t.rule.ruleName)+" "),t.rule.enable?e("a-tag",{staticStyle:{"margin-left":"10px"},attrs:{color:"green"}},[t._v(" 运行中 ")]):t._e()],1),e("a-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[e("a-space",{attrs:{size:"small"}},[e("a-button",{staticStyle:{width:"75px"},on:{click:t.refresh}},[t._v(" 刷新")]),e("a-button",{staticStyle:{width:"75px"},attrs:{type:"danger"},on:{click:t.resetRuntime}},[t._v(" 重置")]),e("a-button",{staticStyle:{width:"75px"},attrs:{type:"primary"},on:{click:t.onClose}},[t._v(" 返回")])],1)],1)],1)],1),e("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1}},[e("a-row",[e("a-col",{attrs:{span:3}},[e("a-statistic",{attrs:{title:"累计总数",value:t.runtime.total}})],1),e("a-col",{attrs:{span:3}},[e("a-statistic",{attrs:{title:"转换成功",value:t.runtime.transformSuccessCount}})],1),e("a-col",{attrs:{span:3}},[e("a-statistic",{attrs:{title:"发送成功",value:t.runtime.publishSuccessCount}})],1),e("a-col",{attrs:{span:3}},[e("a-statistic",{attrs:{title:"转换失败",value:t.runtime.transformFailCount}})],1),e("a-col",{attrs:{span:3}},[e("a-statistic",{attrs:{title:"发送失败",value:t.runtime.publishFailCount}})],1),e("a-col",{attrs:{span:4}},[e("a-statistic",{attrs:{title:"最近执行",value:t.runtime.lastTime?t.runtime.lastTime:"—","value-style":{fontSize:"21px"}}})],1),e("a-col",{attrs:{span:5}},[e("a-statistic",{attrs:{title:"启动时间",value:t.runtime.startTime?t.runtime.startTime:"—","value-style":{fontSize:"21px"}}})],1)],1)],1),e("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1}},[e("a-row",[e("a-col",{attrs:{span:22}},[e("a-descriptions",{attrs:{title:"规则信息",column:2}},[e("a-descriptions-item",{attrs:{label:"规则名称"}},[t._v(t._s(t.rule.ruleName))]),e("a-descriptions-item",{attrs:{label:"忽略空值"}},[t._v(t._s(!0===t.rule.ignoreNullValue?"是":"否"))]),e("a-descriptions-item",{attrs:{label:"转换方式"}},["SCRIPT"===t.rule.transformMode?e("span",[e("a",{on:{click:t.showScript}},[t._v(t._s(t.transformModeMap[t.rule.transformMode]))])]):e("span",[t._v(t._s(t.transformModeMap[t.rule.transformMode]))])]),e("a-descriptions-item",{attrs:{label:"备注"}},[t._v(" "+t._s(t.rule.description?t.rule.description:"无"))]),"PLUGIN"===t.rule.transformMode?e("a-descriptions-item",{attrs:{label:"转换插件"}},[t._v(" "+t._s(t.plugin.pluginName)+" ")]):t._e()],1)],1)],1)],1),e("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1,"body-style":{paddingBottom:"10px"}}},[e("div",{staticClass:"title"},[t._v("数据源")]),t.rule.sourceResourceList&&t.rule.sourceResourceList.length>0?e("a-list",{attrs:{grid:{gutter:24,xs:1,sm:1,md:1,lg:1,xl:1,xxl:1},"data-source":t.rule.sourceResourceList},scopedSlots:t._u([{key:"renderItem",fn:function(a,s){return e("a-list-item",{},[e("a-row",{staticStyle:{"background-color":"#f6f6f6",padding:"15px 10px 0 15px"}},[e("a-col",{attrs:{span:22}},[e("a-descriptions",{attrs:{column:2}},[e("a-descriptions-item",{attrs:{label:"资源名称"}},[t._v(" "+t._s(a.resourceName)+" ")]),e("a-descriptions-item",{attrs:{label:"资源类型"}},[t._v(" "+t._s(t.resourceTypeMap[a.resourceType])+" ")]),t._l(t.getDetails(a),(function(a,s){return e("a-descriptions-item",{key:s,attrs:{label:a.name}},[t._v(" "+t._s(a.value)+" ")])}))],2)],1),e("a-col",{staticStyle:{"text-align":"right","padding-right":"5px"},attrs:{span:2}},[void 0!==a.properties.points?e("a",{on:{click:function(e){return t.pointConfig(a)}}},[t._v("查看点位")]):t._e()])],1)],1)}}],null,!1,111375400)}):t._e()],1),e("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1,"body-style":{paddingBottom:"10px"}}},[e("div",{staticClass:"title"},[t._v("目标资源")]),t.rule.destResourceList&&t.rule.destResourceList.length>0?e("a-list",{attrs:{grid:{gutter:24,xs:1,sm:1,md:1,lg:1,xl:1,xxl:1},"data-source":t.rule.destResourceList},scopedSlots:t._u([{key:"renderItem",fn:function(a,s){return e("a-list-item",{},[e("a-row",{staticStyle:{"background-color":"#f6f6f6",padding:"15px 10px 0 15px"}},[e("a-col",{attrs:{span:22}},[e("a-descriptions",{attrs:{column:2}},[e("a-descriptions-item",{attrs:{label:"资源名称"}},[t._v(" "+t._s(a.resourceName)+" ")]),e("a-descriptions-item",{attrs:{label:"资源类型"}},[t._v(" "+t._s(t.resourceTypeMap[a.resourceType])+" ")]),t._l(t.getDetails(a),(function(a,s){return e("a-descriptions-item",{key:s,attrs:{label:a.name}},[t._v(" "+t._s(a.value)+" ")])}))],2)],1),e("a-col",{staticStyle:{"text-align":"right","padding-right":"5px"},attrs:{span:2}},[void 0!==a.properties.points?e("a",{on:{click:function(e){return t.pointConfig(a)}}},[t._v("查看点位")]):t._e()])],1)],1)}}],null,!1,111375400)}):t._e()],1),t.variables.length>0?e("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1}},[e("div",{staticClass:"title"},[t._v("环境变量")]),e("a-table",{staticStyle:{"margin-bottom":"20px"},attrs:{columns:t.varColumns,"data-source":t.variables,size:"middle",pagination:!1}})],1):t._e(),e("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1}},[e("div",{staticClass:"title"},[t._v(" 最近数据 "),e("span",{staticStyle:{cursor:"pointer"},on:{click:t.refresh}},[e("a-icon",{attrs:{type:"redo"}})],1)]),e("a-table",{attrs:{columns:t.dataColumns,"data-source":t.runtime.lastData,size:"middle",pagination:!1},scopedSlots:t._u([{key:"receiveData",fn:function(a){return e("span",{},[t._v(" "+t._s(a||"—")+" ")])}},{key:"transformSuccess",fn:function(a,s){return e("span",{},[e("a-popover",{attrs:{title:"转换结果"}},[e("template",{slot:"content"},[t._v(" "+t._s(s.transformData?s.transformData:"—")+" ")]),e("span",{staticStyle:{cursor:"pointer"}},[!0===a?e("a-badge",{attrs:{color:"green",text:"成功"}}):t._e(),!1===a?e("a-badge",{attrs:{color:"red",text:"失败"}}):t._e()],1)],2)],1)}},{key:"publishSuccess",fn:function(a,s){return e("span",{},[e("a-popover",{attrs:{title:"发送数据"}},[e("template",{slot:"content"},[t._v(" "+t._s(s.publishData?s.publishData:"—")+" ")]),e("span",{staticStyle:{cursor:"pointer"}},[!0===a?e("a-badge",{attrs:{color:"green",text:"成功"}}):t._e(),!1===a?e("a-badge",{attrs:{color:"red",text:"失败"}}):t._e()],1)],2)],1)}}])})],1),e("points-config-model",{ref:"PointsConfigModel"}),e("script-view-model",{ref:"ScriptViewModel"})],1)},r=[],i=(a("b64b"),a("0fea")),n=a("56fc"),o=a("8e45"),l=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"解析脚本",width:900,visible:t.visible,bodyStyle:{padding:0},footer:null},on:{cancel:t.onClose}},[e("div",{staticClass:"scriptView"},[e("monaco-editor",{ref:"MonacoEditor",attrs:{"read-only":!0,height:"500px",border:!1,minimap:!0}})],1)])},c=[],u=a("2200c"),d={name:"ScriptViewModel",components:{MonacoEditor:u["a"]},data:function(){return{visible:!1}},methods:{show:function(t){var e=this;this.visible=!0,this.$nextTick((function(){e.$refs.MonacoEditor.set(t)}))},onClose:function(){this.visible=!1}}},p=d,m=a("2877"),f=Object(m["a"])(p,l,c,!1,null,null,null),b=f.exports,g=a("dfd5"),v={components:{ScriptViewModel:b,PointsConfigModel:g["a"]},data:function(){return{url:{runtime:"/api/runtime/info",rule:"/api/rule/info",reset:"/api/runtime/reset",plugin:"/api/plugin/info"},rule:{},runtime:{},variables:[],plugin:{},transformModeMap:o["b"],resourceTypeMap:n["d"],dataColumns:[{title:"时间",dataIndex:"time"},{title:"接收数据",dataIndex:"receiveData",scopedSlots:{customRender:"receiveData"}},{title:"转换",dataIndex:"transformSuccess",scopedSlots:{customRender:"transformSuccess"}},{title:"发送",dataIndex:"publishSuccess",scopedSlots:{customRender:"publishSuccess"}},{title:"说明",dataIndex:"message"}],varColumns:[{title:"变量名称",dataIndex:"name",width:"30%"},{title:"初始值",dataIndex:"initValue"},{title:"当前值",dataIndex:"value"}]}},mounted:function(){this.ruleId=this.$route.params.ruleId,this.getInfo()},methods:{showScript:function(){this.$refs.ScriptViewModel.show(this.rule.script)},refresh:function(){this.getInfo(),this.$message.success("刷新成功")},resetRuntime:function(){var t=this;this.$confirm({title:"重置运行状态?",content:"此操作将会清空运行统计数据、还原变量初始值",onOk:function(){Object(i["b"])(t.url.reset,{ruleId:t.ruleId}).then((function(e){200===e.code?(t.getInfo(),t.$message.success("重置成功")):t.$message.error("重置失败")}))}})},getInfo:function(){var t=this;this.ruleId&&Object(i["b"])(this.url.rule,{ruleId:this.ruleId}).then((function(e){t.rule=e.data,t.rule&&(t.getRuntime(),"PLUGIN"===t.rule.transformMode&&t.getPlugin())}))},getRuntime:function(){var t=this;Object(i["b"])(this.url.runtime,{ruleId:this.ruleId}).then((function(e){if(t.runtime=e.data,t.variables=[],t.rule.variables)for(var a=Object.keys(t.rule.variables),s=0,r=a;s<r.length;s++){var i=r[s];t.variables.push({name:i,value:t.runtime.variables[i],initValue:t.rule.variables[i]})}}))},getPlugin:function(){var t=this;Object(i["b"])(this.url.plugin,{pluginId:this.rule.pluginId}).then((function(e){t.plugin=e.data}))},onClose:function(){this.$router.push({name:"ruleList"})},getDetails:function(t){return Object(n["a"])(t,"rule")},pointConfig:function(t){this.$refs.PointsConfigModel.show(t.resourceType,t.properties.points)}}},h=v,_=(a("eeb2"),Object(m["a"])(h,s,r,!1,null,"422d92f8",null));e["default"]=_.exports},c552:function(t,e,a){},eeb2:function(t,e,a){"use strict";a("c552")}}]);