(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32503117"],{2173:function(t,a,e){"use strict";e("6e92")},"6e92":function(t,a,e){},ec74:function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-row",{attrs:{gutter:20}},[e("a-form-model",{ref:"ruleForm",attrs:{model:t.modal,layout:"vertical",rules:t.rules}},[e("a-col",{attrs:{span:15}},[e("a-card",{attrs:{title:"脚本","body-style":{paddingBottom:0}}},[e("div",{staticStyle:{padding:"0"},attrs:{slot:"extra"},slot:"extra"},[t.disSaveBtn?t._e():e("a-popconfirm",{attrs:{title:"放弃编辑的内容?"},on:{confirm:function(){t.onClose()}}},[e("a-button",{style:{marginRight:"8px"},attrs:{icon:"rollback"}},[t._v(" 返回")])],1),t.disSaveBtn?e("a-button",{style:{marginRight:"8px"},attrs:{icon:"rollback"},on:{click:t.onClose}},[t._v(" 返回")]):t._e(),e("a-button",{attrs:{type:"primary",icon:"save",disabled:t.disSaveBtn},on:{click:t.saveScript}},[t._v(" 保存")])],1),e("a-row",{attrs:{gutter:20}},[e("a-col",{attrs:{span:9}},[e("a-form-model-item",{attrs:{label:"名称",prop:"scriptName"}},[e("a-input",{attrs:{placeholder:"请输入脚本名称"},model:{value:t.modal.scriptName,callback:function(a){t.$set(t.modal,"scriptName",a)},expression:"modal.scriptName"}})],1)],1),e("a-col",{attrs:{span:9}},[e("a-form-model-item",{attrs:{label:"说明",prop:"description"}},[e("a-input",{attrs:{placeholder:"请输入脚本说明"},model:{value:t.modal.description,callback:function(a){t.$set(t.modal,"description",a)},expression:"modal.description"}})],1)],1),e("a-col",{attrs:{span:6}},[e("a-form-model-item",{attrs:{label:"最后修改",prop:"description"}},[e("a-input",{attrs:{placeholder:"最后修改时间","read-only":!0},model:{value:t.modal.updateTime,callback:function(a){t.$set(t.modal,"updateTime",a)},expression:"modal.updateTime"}})],1)],1),e("a-col",{staticClass:"scriptModel",attrs:{span:24}},[e("a-form-model-item",{attrs:{label:"JavaScript脚本",prop:"scriptContent"}},[e("codemirror",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{options:t.options},on:{change:t.contentChange},model:{value:t.modal.scriptContent,callback:function(a){t.$set(t.modal,"scriptContent",a)},expression:"modal.scriptContent"}})],1)],1)],1)],1)],1),e("a-col",{attrs:{span:9}},[e("a-card",{attrs:{title:"调试","body-style":{paddingBottom:0}}},[e("div",{staticStyle:{padding:"0"},attrs:{slot:"extra"},slot:"extra"},[e("a-button",{staticClass:"runBtn",attrs:{type:"primary",icon:"caret-right",disabled:!t.modal.paramContent},on:{click:t.runScript}},[t._v(" 运行 ")])],1),e("a-row",{attrs:{gutter:20}},[e("a-col",{staticClass:"inputModel",attrs:{span:24}},[e("a-form-model-item",{attrs:{label:"输入参数（Json）",prop:"paramContent"}},[e("div",{staticStyle:{"margin-top":"-30px",width:"100%","text-align":"right",height:"30px",color:"#000000","padding-top":"4px"}},[e("a",{on:{click:t.formatParam}},[e("a-icon",{attrs:{type:"menu-unfold"}})],1)]),e("codemirror",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{options:t.options},model:{value:t.modal.paramContent,callback:function(a){t.$set(t.modal,"paramContent",a)},expression:"modal.paramContent"}})],1)],1),e("a-col",{staticClass:"outputModel",attrs:{span:24}},[e("a-form-model-item",{attrs:{label:"运行结果",prop:"resultContent"}},[e("div",{staticStyle:{"margin-top":"-30px",width:"100%","text-align":"right",height:"30px",color:"#000000"}},[e("span",{directives:[{name:"show",rawName:"v-show",value:t.time>=0,expression:"time >= 0"}],staticStyle:{display:"inline-block","padding-right":"15px"}},[t._v("用时："+t._s(t.time)+"ms")]),e("a",{on:{click:t.formatResult}},[e("a-icon",{attrs:{type:"menu-unfold"}})],1)]),e("codemirror",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{options:t.options},model:{value:t.modal.resultContent,callback:function(a){t.$set(t.modal,"resultContent",a)},expression:"modal.resultContent"}})],1)],1)],1)],1)],1)],1)],1)},r=[],n=(e("d3b7"),e("0fea")),i=e("ca00"),s=e("c884");e("f9d4"),e("693d8"),e("9b74"),e("f6b6"),e("3c98"),e("cc10"),e("31c5");var l={name:"ResourceModel",components:{codemirror:s["codemirror"]},props:{scriptId:{type:String,default:void 0}},data:function(){return{title:"操作",visible:!1,confirmLoading:!1,modal:{scriptContent:"/**\n* 方法名transform不可修改,入参：data Object 源数据,出参：data Object 目标数据\n*/\nfunction transform(data) {\n    return data;\n}",paramContent:"{}",resultContent:""},url:{info:"/api/script/info",add:"/api/script/add",update:"/api/script/update",run:"/api/script/run"},rules:{scriptName:[{required:!0,message:"请输入脚本名称",trigger:"blur"}],scriptContent:[{required:!0,message:"请输入脚本内容",trigger:"blur"}]},options:{mode:{name:"text/javascript",json:!0},height:450,lineNumbers:!0,tabSize:2,theme:"base16-light",line:!0,autoCloseTags:!0,lineWrapping:!0,styleActiveLine:!0,extraKeys:{tab:"autocomplete"},hintOptions:{tables:{}}},disSaveBtn:!0,time:-1}},mounted:function(){var t=this;this.scriptId&&Object(n["a"])(this.url.info,{scriptId:this.scriptId}).then((function(a){t.modal=a.data}))},methods:{formatParam:function(){this.modal.paramContent=Object(i["a"])(this.modal.paramContent)},formatResult:function(){this.modal.resultContent=Object(i["a"])(this.modal.resultContent)},runScript:function(){var t=this;Object(n["b"])(this.url.run,this.modal).then((function(a){200===a.code?(t.modal.resultContent=JSON.stringify(a.data.result),t.time=a.data.time,t.$message.success("运行成功")):t.$message.error("运行失败: "+a.message)}))},contentChange:function(){this.disSaveBtn=!1},saveScript:function(){var t=this,a=this;this.$refs.ruleForm.validate((function(e){if(!e)return!1;a.confirmLoading=!0;var o,r=JSON.parse(JSON.stringify(t.modal));o=t.scriptId?Object(n["c"])(t.url.update,r):Object(n["b"])(t.url.add,r),o.then((function(t){200===t.code?(a.$message.success("保存成功"),a.disSaveBtn=!0,a.modal=t.data):a.$message.warning("保存失败")})).finally((function(){a.confirmLoading=!1}))}))},onClose:function(){this.$router.push({name:"scriptList"})}}},c=l,d=(e("2173"),e("2877")),p=Object(d["a"])(c,o,r,!1,null,null,null);a["default"]=p.exports}}]);