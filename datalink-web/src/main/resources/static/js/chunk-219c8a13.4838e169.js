(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-219c8a13"],{"1faf":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("page-header-wrapper",{attrs:{breadcrumb:!1}},[t("a-card",{staticStyle:{"margin-bottom":"15px"},attrs:{"body-style":{paddingBottom:0},bordered:!1}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"用户名"}},[t("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}})],1)],1),t("a-col",{attrs:{md:14,sm:24}},[t("a-button",{attrs:{type:"primary"},on:{click:e.loadData}},[e._v("查询")]),t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{md:3,sm:24}},[t("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("新建用户")])],1)],1)],1)],1)]),t("a-card",{attrs:{"body-style":{minHeight:"500px"},bordered:!1}},[t("a-table",{ref:"table",attrs:{rowKey:"username",columns:e.columns,"data-source":e.dataSource,pagination:!1,loading:e.loading},scopedSlots:e._u([{key:"serial",fn:function(a,n,r){return t("span",{},[e._v(" "+e._s(r+1)+" ")])}},{key:"description",fn:function(a,n,r){return t("span",{},[e._v(" "+e._s(a||"-")+" ")])}},{key:"action",fn:function(a,n){return t("span",{},[[t("a",{on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.handlePassword(n)}}},[e._v("密码")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{attrs:{disabled:n.system},on:{click:function(t){return e.handlePermission(n)}}},[e._v("权限")]),t("a-divider",{attrs:{type:"vertical"}}),e.dataSource.length?t("a-popconfirm",{attrs:{title:"删除此脚本?"},on:{confirm:function(){return e.handleDelete(n)}}},[t("a",{attrs:{href:"javascript:;",disabled:n.system}},[e._v("删除")])]):e._e()]],2)}}])})],1),t("user-model",{ref:"UserModel",on:{ok:e.loadData}}),t("password-model",{ref:"PasswordModel"}),t("permission-model",{ref:"PermissionModel"})],1)},r=[],i=(a("a4d3"),a("e01a"),function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{confirmLoading:e.confirmLoading,title:"用户",width:600,visible:e.visible,destroyOnClose:!0},on:{cancel:e.onClose}},[t("a-form-model",{ref:"ruleForm",attrs:{model:e.modal,layout:"vertical",rules:e.rules}},[t("a-form-model-item",{attrs:{label:"用户名",prop:"username"}},[t("a-input",{attrs:{placeholder:"请输入用户名",disabled:e.isEdit},model:{value:e.modal.username,callback:function(t){e.$set(e.modal,"username",t)},expression:"modal.username"}})],1),e.isEdit?e._e():t("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[t("a-input-password",{attrs:{placeholder:"请输入密码"},model:{value:e.modal.password,callback:function(t){e.$set(e.modal,"password",t)},expression:"modal.password"}})],1),t("a-form-model-item",{attrs:{label:"备注"}},[t("a-input",{attrs:{placeholder:"请输入备注"},model:{value:e.modal.description,callback:function(t){e.$set(e.modal,"description",t)},expression:"modal.description"}})],1)],1),t("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[t("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" 取消")]),t("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" 确定")])],1)],1)}),s=[],o=(a("d3b7"),a("0fea")),d={name:"UserModel",data:function(){return{title:"操作",visible:!1,confirmLoading:!1,modal:{},url:{add:"/api/user/add",update:"/api/user/update"},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},isEdit:!1}},methods:{add:function(){this.edit({})},edit:function(e){this.modal=JSON.parse(JSON.stringify(e)),this.isEdit=!!e.username,this.visible=!0},onClose:function(){this.visible=!1},handleOk:function(){var e=this,t=this;this.$refs.ruleForm.validate((function(a){if(!a)return!1;var n;t.confirmLoading=!0,n=e.isEdit?Object(o["d"])(e.url.update,e.modal):Object(o["c"])(e.url.add,e.modal),n.then((function(e){200===e.code?(t.$message.success("保存成功"),t.$emit("ok")):t.$message.error(e.message)})).finally((function(){t.confirmLoading=!1,t.onClose()}))}))},filterOption:function(e,t){return!!t.componentOptions.children[0].text&&t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}}},l=d,c=a("2877"),u=Object(c["a"])(l,i,s,!1,null,"5bb657ab",null),m=u.exports,p=a("b53c"),f=(a("b0c0"),function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"权限",width:600,visible:e.visible,destroyOnClose:!0},on:{cancel:e.onClose}},[t("a-checkbox-group",{staticStyle:{width:"100%"},model:{value:e.checkedList,callback:function(t){e.checkedList=t},expression:"checkedList"}},[t("a-row",{attrs:{gutter:24}},e._l(e.dataList,(function(a,n){return t("a-col",{key:n,staticStyle:{margin:"10px 0"},attrs:{span:6}},[t("a-checkbox",{attrs:{value:a.value,disabled:"dashboard"===a.value}},[e._v(" "+e._s(a.name)+" ")])],1)})),1)],1),t("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[t("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" 取消")]),t("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" 确定")])],1)],1)}),h=[],b=a("b85c"),v=a("d73b"),g={data:function(){return{record:{},dataList:[],checkedList:[],visible:!1}},mounted:function(){this.getList()},methods:{open:function(e){this.record=e,this.checkedList=Object.assign([],e.permissions),this.visible=!0},onClose:function(){this.record={},this.checkedList=[],this.visible=!1},handleOk:function(){var e=this;!this.checkedList||this.checkedList.length<1?this.$message.error("至少选择一项"):(this.record.permissions=this.checkedList,Object(o["d"])("/api/user/update",this.record).then((function(t){200===t.code?e.$message.success("保存成功"):e.$message.error(t.message)})).finally((function(){e.onClose()})))},getList:function(){this.dataList=[];var e,t=Object(b["a"])(v["a"][0].children);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.meta&&a.meta.permission&&this.dataList.push({name:a.meta.title,value:a.meta.permission})}}catch(n){t.e(n)}finally{t.f()}}}},y=g,k=Object(c["a"])(y,f,h,!1,null,null,null),x=k.exports,w={name:"UserList",components:{PermissionModel:x,PasswordModel:p["a"],UserModel:m},data:function(){return{columns:[{title:"用户名",dataIndex:"username"},{title:"备注",dataIndex:"description",scopedSlots:{customRender:"description"}},{title:"创建时间",dataIndex:"createTime"},{title:"操作",dataIndex:"action",width:"250px",scopedSlots:{customRender:"action"}}],dataSource:[],loading:!0,queryParam:{}}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0,Object(o["c"])("/api/user/list",this.queryParam).then((function(t){e.dataSource=t.data,e.loading=!1}))},handleDelete:function(e){var t=this;Object(o["c"])("/api/user/remove",{username:e.username}).then((function(e){200===e.code?(t.$message.success("删除成功"),t.loadData()):t.$message.error("删除失败")}))},handleAdd:function(){this.$refs.UserModel.add()},handleEdit:function(e){this.$refs.UserModel.edit(e)},handlePassword:function(e){this.$refs.PasswordModel.open(e.username)},handlePermission:function(e){this.$refs.PermissionModel.open(e)},reset:function(){this.queryParam={},this.loadData()}}},_=w,L=Object(c["a"])(_,n,r,!1,null,null,null);t["default"]=L.exports},b85c:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");var n=a("06c5");function r(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=Object(n["a"])(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,d=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){d=!0,s=e},f:function(){try{o||null==a["return"]||a["return"]()}finally{if(d)throw s}}}}}}]);