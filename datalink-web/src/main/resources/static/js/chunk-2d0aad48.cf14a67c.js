(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0aad48"],{"134d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",{attrs:{breadcrumb:!1}},[a("a-card",{staticStyle:{"margin-bottom":"15px"},attrs:{"body-style":{paddingBottom:0},bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:7,sm:24}},[a("a-form-item",{attrs:{label:"插件名称"}},[a("a-input",{attrs:{placeholder:"请输入插件名称"},model:{value:e.queryParam.pluginName,callback:function(t){e.$set(e.queryParam,"pluginName",t)},expression:"queryParam.pluginName"}})],1)],1),a("a-col",{attrs:{md:14,sm:24}},[a("a-button",{attrs:{type:"primary"},on:{click:e.loadData}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1),a("a-col",{staticStyle:{"text-align":"right"},attrs:{md:3,sm:24}},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("新建插件")])],1)],1)],1)],1)]),a("a-card",{attrs:{"body-style":{minHeight:"500px"},bordered:!1}},[a("a-table",{ref:"table",attrs:{rowKey:"pluginId",columns:e.columns,"data-source":e.dataSource,pagination:!1,loading:e.loading},scopedSlots:e._u([{key:"serial",fn:function(t,n,o){return a("span",{},[e._v(" "+e._s(o+1)+" ")])}},{key:"description",fn:function(t,n,o){return a("span",{},[e._v(" "+e._s(t||"-")+" ")])}},{key:"action",fn:function(t,n){return a("span",{},[[a("a",{on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.download(n)}}},[e._v("下载")]),a("a-divider",{attrs:{type:"vertical"}}),e.dataSource.length?a("a-popconfirm",{attrs:{title:"删除此插件?"},on:{confirm:function(){return e.handleDelete(n)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("删除")])]):e._e()]],2)}}])})],1),a("plugin-model",{ref:"PluginModel",on:{ok:e.loadData}})],1)},o=[],i=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("0fea")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{confirmLoading:e.confirmLoading,title:"插件",width:600,visible:e.visible,destroyOnClose:!0},on:{cancel:e.onClose}},[a("a-form-model",{ref:"ruleForm",attrs:{model:e.modal,layout:"vertical",rules:e.rules}},[a("a-form-model-item",{attrs:{label:"名称",prop:"pluginName"}},[a("a-input",{attrs:{placeholder:"请上传插件文件","read-only":!0},model:{value:e.modal.pluginName,callback:function(t){e.$set(e.modal,"pluginName",t)},expression:"modal.pluginName"}})],1),a("a-form-model-item",{attrs:{label:"包路径",prop:"packagePath"}},[a("a-input",{attrs:{placeholder:"请输入包路径"},model:{value:e.modal.packagePath,callback:function(t){e.$set(e.modal,"packagePath",t)},expression:"modal.packagePath"}})],1),a("a-form-model-item",{attrs:{label:"说明"}},[a("a-input",{attrs:{placeholder:"请输入说明"},model:{value:e.modal.description,callback:function(t){e.$set(e.modal,"description",t)},expression:"modal.description"}})],1)],1),a("a-form-item",{attrs:{label:"文件上传"}},[a("div",{key:Math.random()},[a("a-upload",{attrs:{showUploadList:!1,beforeUpload:e.checkFile,customRequest:e.customRequest},on:{change:e.handlerUpload}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 选择文件 ")],1)],1)],1)]),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" 取消")]),a("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" 确定")])],1)],1)},l=[],s=(a("b0c0"),{name:"PluginModel",data:function(){return{title:"操作",visible:!1,confirmLoading:!1,modal:{pluginName:""},url:{add:"/api/plugin/add",update:"/api/plugin/update"},rules:{pluginName:[{required:!0,message:"请输入插件名称",trigger:"change"}],packagePath:[{required:!0,message:"请输入包路径",trigger:"blur"}]},isEdit:!1}},methods:{add:function(){this.edit({})},edit:function(e){this.modal=Object.assign({},this.modal,e),this.isEdit=!!e.key,this.visible=!0},onClose:function(){this.modal={pluginName:""},this.visible=!1},handleOk:function(){var e=this,t=this;this.$refs.ruleForm.validate((function(a){if(!a)return!1;var n;t.confirmLoading=!0,n=e.isEdit?Object(i["d"])(e.url.update,e.modal):Object(i["c"])(e.url.add,e.modal),n.then((function(e){200===e.code?(t.$message.success("保存成功"),t.$emit("ok")):t.$message.error("保存失败")})).finally((function(){t.confirmLoading=!1,t.onClose()}))}))},filterOption:function(e,t){return!!t.componentOptions.children[0].text&&t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},checkFile:function(e){var t=e.size/1024/1024<100;if(!t)return this.$message.error("文件大小不能超过100M！"),!1;var a=["jar"],n=e.name.split(".").pop();return n&&(n=n.toLowerCase()),-1!==a.indexOf(n)||(this.$message.error("文件格式不合法！"),!1)},handlerUpload:function(e){e.file.status,"done"===e.file.status?200===e.file.response.code?(this.modal.pluginName=e.file.response.data.name,this.$message.success("".concat(e.file.name," 上传成功"))):this.$message.error("上传出错,".concat(e.file.response.message)):"error"===e.file.status&&this.$message.error("上传出错")},customRequest:function(e){var t=new FormData;t.append("file",e.file),Object(i["e"])("/api/plugin/upload",t).then((function(t){e.onSuccess(t,e.file)}))}}}),d=s,c=a("2877"),u=Object(c["a"])(d,r,l,!1,null,"7ddd7e57",null),m=u.exports,p={name:"ScriptList",components:{PluginModel:m},data:function(){return{columns:[{title:"插件名称",dataIndex:"pluginName"},{title:"包路径",dataIndex:"packagePath"},{title:"说明",dataIndex:"description",scopedSlots:{customRender:"description"}},{title:"最后修改",dataIndex:"updateTime"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],dataSource:[],loading:!0,queryParam:{}}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0,Object(i["c"])("/api/plugin/list",this.queryParam).then((function(t){e.dataSource=t.data,e.loading=!1}))},handleDelete:function(e){var t=this;Object(i["c"])("/api/plugin/remove",e).then((function(e){200===e.code?(t.$message.success("删除成功"),t.loadData()):t.$message.error(e.message)}))},handleAdd:function(){this.$refs.PluginModel.add()},handleEdit:function(e){this.$refs.PluginModel.edit(e)},reset:function(){this.queryParam={},this.loadData()},download:function(e){Object(i["a"])("/api/plugin/download",{pluginName:e.pluginName}).then((function(t){var a=new Blob([t]),n=document.createElement("a"),o=window.URL.createObjectURL(a);n.href=o,n.download=decodeURIComponent(e.pluginName),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(o)}))}}},f=p,g=Object(c["a"])(f,n,o,!1,null,null,null);t["default"]=g.exports}}]);