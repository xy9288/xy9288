(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1948d7a0"],{"1eaa":function(e,t,r){},2909:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r("6b75");function o(e){if(Array.isArray(e))return Object(a["a"])(e)}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("a630");function i(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=r("06c5");function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return o(e)||i(e)||Object(s["a"])(e)||n()}},"56fc":function(e,t,r){"use strict";r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return p})),r.d(t,"a",(function(){return u}));var a=r("b85c"),o=(r("99af"),r("b0c0"),r("995a")),i="all",s="source",n={MQTT:{name:"MQTT Broker",type:i,details:{resource:{name:"资源地址",format:function(e){return e.properties.url}},rule:[{name:"资源地址",format:function(e){return e.properties.url}},{name:"Topic",format:function(e){return e.properties.topic}}]}},KAFKA:{name:"Kafka",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},{name:"Topic",format:function(e){return e.properties.topic}}]}},MYSQL:{name:"MySQL",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",format:function(e){return e.properties.sql}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"查询频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},POSTGRESQL:{name:"PostgreSQL",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",format:function(e){return e.properties.sql}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"查询频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},SQLSERVER:{name:"SQL Server",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",format:function(e){return e.properties.sql}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"查询频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},TDENGINE:{name:"TDengine",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",format:function(e){return e.properties.sql}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"查询频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},HTTP:{name:"HTTP",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},rule:[{name:"请求路径",format:function(e){return"".concat(e.properties.url).concat(e.properties.path)}},{name:"请求方式",format:function(e){return"".concat(e.properties.method)}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"调用频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},OPCUA:{name:"OPC UA",type:s,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},{name:"读取点位",format:function(e){return"".concat(e.properties.points?e.properties.points.length:0)}}]}},REDIS:{name:"Redis",type:i,details:{resource:{name:"资源地址",format:function(e){return"STANDALONE"===e.properties.mode?"".concat(e.properties.ip,":").concat(e.properties.port):"".concat(e.properties.nodes)}},rule:[{name:"资源地址",format:function(e){return"STANDALONE"===e.properties.mode?"".concat(e.properties.ip,":").concat(e.properties.port):"".concat(e.properties.nodes)}},{name:"执行命令",format:function(e){return"".concat(e.properties.command)}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"调用频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}}};function l(){var e={};for(var t in n)e[t]=n[t].name;return e}var c=l();function p(e){var t=[];for(var r in n){var a=n[r].type;if(!e||a===i||a===e){var o={name:n[r].name,code:r,type:a};t.push(o)}}return t}function u(e,t){if(!e||!e.resourceType)return"resource"===t?{name:"",value:""}:[{name:"",value:""}];var r=n[e.resourceType],o=r.details[t];if("resource"===t){var i=o.format(e);return i?{name:o.name,value:i}:{name:"",value:""}}var s,l=[],c=Object(a["a"])(o);try{for(c.s();!(s=c.n()).done;){var p=s.value,u=p.format(e);u&&l.push({name:p.name,value:u})}}catch(d){c.e(d)}finally{c.f()}return l}},"5c42":function(e,t,r){"use strict";r("1eaa")},"8e45":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var a={WITHOUT:"无转换透传",SCRIPT:"JS脚本转换",PLUGIN:"插件转换"};function o(){var e=[];for(var t in a)e.push({name:a[t],value:t});return e}var i=o()},"995a":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var a={SECONDS:"秒",MINUTES:"分",HOURS:"时",DAYS:"天"};function o(){var e=[];for(var t in a)e.push({name:a[t],value:t});return e}var i=o()},b12c:function(e,t,r){"use strict";r("ff34")},d45d:function(e,t,r){"use strict";r.r(t);r("a4d3"),r("e01a"),r("b0c0");var a=function(){var e=this,t=e._self._c;return t("div",[t("a-form-model",{ref:"ruleForm",attrs:{model:e.modal,layout:"vertical",rules:e.rules}},[t("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1,"body-style":{padding:"17px 24px"}}},[t("a-row",[t("a-col",{staticStyle:{"font-size":"16px","font-weight":"bold",color:"rgba(0, 0, 0, 0.85)","padding-top":"4px"},attrs:{span:12}},[e._v(" "+e._s(e.modal.ruleId?"编辑":"新建")+"规则 ")]),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[t("a-space",{attrs:{size:"small"}},[t("a-button",{staticStyle:{width:"75px"},on:{click:e.onClose}},[e._v(" 取消")]),t("a-button",{staticStyle:{width:"75px"},attrs:{type:"primary"},on:{click:e.saveRule}},[e._v(" 保存")])],1)],1)],1)],1),t("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{"body-style":{paddingBottom:0},bordered:!1}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"名称",prop:"ruleName"}},[t("a-input",{attrs:{placeholder:"请输入规则名称"},model:{value:e.modal.ruleName,callback:function(t){e.$set(e.modal,"ruleName",t)},expression:"modal.ruleName"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"备注"}},[t("a-input",{attrs:{placeholder:"请输入备注"},model:{value:e.modal.description,callback:function(t){e.$set(e.modal,"description",t)},expression:"modal.description"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"数据转换方式",prop:"transformMode"}},[t("a-select",{attrs:{placeholder:"请选择数据转换方式"},on:{change:e.transformModeChange},model:{value:e.modal.transformMode,callback:function(t){e.$set(e.modal,"transformMode",t)},expression:"modal.transformMode"}},e._l(e.transformModeList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(" "+e._s(r.name)+" ")])})),1)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"忽略空数据",prop:"ignoreNullValue"}},[t("a-select",{attrs:{placeholder:"请选择是否忽略空数据"},model:{value:e.modal.ignoreNullValue,callback:function(t){e.$set(e.modal,"ignoreNullValue",t)},expression:"modal.ignoreNullValue"}},[t("a-select-option",{attrs:{value:!0}},[e._v("是")]),t("a-select-option",{attrs:{value:!1}},[e._v("否")])],1)],1)],1)],1)],1),t("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1}},[t("div",{staticClass:"title"},[e._v("数据源")]),e.modal.sourceResource?t("a-row",{staticStyle:{"background-color":"#f6f6f6",padding:"15px 10px 0 15px"}},[t("a-col",{attrs:{span:18}},[t("a-descriptions",{attrs:{column:2}},[t("a-descriptions-item",{attrs:{label:"资源名称"}},[e._v(" "+e._s(e.modal.sourceResource.resourceName)+" ")]),t("a-descriptions-item",{attrs:{label:"资源类型"}},[e._v(" "+e._s(e.resourceTypeMap[e.modal.sourceResource.resourceType])+" ")]),e._l(e.getDetails(e.modal.sourceResource),(function(r,a){return t("a-descriptions-item",{key:a,attrs:{label:r.name}},[e._v(" "+e._s(r.value)+" ")])}))],2)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("a",{on:{click:function(t){return e.freshResource("source",e.modal.sourceResource)}}},[e._v("刷新")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.editResource("source",e.modal.sourceResource)}}},[e._v("配置")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"移除此资源?"},on:{confirm:function(){return e.deleteResource("source")}}},[t("a",{attrs:{href:"javascript:;"}},[e._v("移除")])])],1)],1):e._e(),e.modal.sourceResource?e._e():t("a-button",{on:{click:function(t){return e.addResource("source")}}},[e._v(" 绑定数据源")])],1),t("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1}},[t("div",{staticClass:"title"},[e._v("目标资源")]),e.modal.destResourceList.length>0?t("a-list",{attrs:{grid:{gutter:16,xs:1,sm:1,md:1,lg:1,xl:1,xxl:1},"data-source":e.modal.destResourceList},scopedSlots:e._u([{key:"renderItem",fn:function(r,a){return t("a-list-item",{},[t("a-row",{staticStyle:{"background-color":"#f6f6f6",padding:"15px 10px 0 15px"}},[t("a-col",{attrs:{span:18}},[t("a-descriptions",{attrs:{column:2}},[t("a-descriptions-item",{attrs:{label:"资源名称"}},[e._v(" "+e._s(r.resourceName)+" ")]),t("a-descriptions-item",{attrs:{label:"资源类型"}},[e._v(" "+e._s(e.resourceTypeMap[r.resourceType])+" ")]),e._l(e.getDetails(r),(function(r,a){return t("a-descriptions-item",{key:a,attrs:{label:r.name}},[e._v(" "+e._s(r.value)+" ")])}))],2)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("a",{on:{click:function(t){return e.freshResource("dest",r,a)}}},[e._v("刷新")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.editResource("dest",r,a)}}},[e._v("配置")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"移除此资源?"},on:{confirm:function(){return e.deleteResource("dest",a)}}},[t("a",{attrs:{href:"javascript:;"}},[e._v("移除")])])],1)],1)],1)}}],null,!1,3910203105)}):e._e(),t("a-button",{on:{click:function(t){return e.addResource("dest")}}},[e._v(" 添加目标资源")])],1),"WITHOUT"!==e.modal.transformMode?t("a-card",{staticStyle:{"margin-bottom":"24px"},attrs:{bordered:!1}},[t("a-row",{staticStyle:{padding:"0"}},[t("a-col",{staticClass:"title",attrs:{span:12}},[e._v("数据转换")]),"SCRIPT"===e.modal.transformMode?t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[t("a",{on:{click:e.selectScript}},[e._v("选择脚本")])]):e._e()],1),t("a-row",{attrs:{gutter:24}},["SCRIPT"===e.modal.transformMode?t("a-col",{attrs:{span:24}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{height:"300px",minimap:!0}})],1):e._e(),"PLUGIN"===e.modal.transformMode?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"插件",prop:"script"}},[t("a-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择插件"},model:{value:e.modal.pluginId,callback:function(t){e.$set(e.modal,"pluginId",t)},expression:"modal.pluginId"}},e._l(e.pluginList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.pluginId}},[e._v(" "+e._s(r.pluginName)+" ")])})),1)],1)],1):e._e()],1)],1):e._e(),t("variables-model",{ref:"VariablesModel"})],1),t("resource-model",{ref:"ResourceModel",on:{update:e.handleUpdateResource,add:e.handleAddResource}}),t("script-select-model",{ref:"ScriptSelectModel",on:{select:e.handleSelectedScript}})],1)},o=[],i=(r("a434"),r("d3b7"),r("0fea")),s=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{confirmLoading:e.confirmLoading,title:"source"===e.resourceMode?"源数据":"目标资源",width:550,visible:e.visible,destroyOnClose:!0},on:{cancel:e.onClose}},[t("a-form-model",{ref:"ruleForm",attrs:{model:e.modal,layout:"vertical",rules:e.rules}},[t("a-form-model-item",{attrs:{label:"类型",prop:"resourceType"}},[t("a-select",{attrs:{placeholder:"请选择资源类型"},on:{change:e.resourceTypeChange},model:{value:e.modal.resourceType,callback:function(t){e.$set(e.modal,"resourceType",t)},expression:"modal.resourceType"}},e._l(e.resourceTypeList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.code}},[e._v(e._s(r.name)+" ")])})),1)],1),t("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.modal.resourceType,expression:"modal.resourceType"}],attrs:{label:"资源",prop:"resourceId"}},[t("a-select",{attrs:{placeholder:"请选择资源"},on:{change:e.resourceChange},model:{value:e.modal.resourceId,callback:function(t){e.$set(e.modal,"resourceId",t)},expression:"modal.resourceId"}},e._l(e.resourceList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.resourceId}},[e._v(" "+e._s(r.resourceName)+" ")])})),1)],1),"MQTT"===e.modal.resourceType?t("mqtt-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"KAFKA"===e.modal.resourceType?t("kafka-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"MYSQL"===e.modal.resourceType?t("MysqlProperties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"POSTGRESQL"===e.modal.resourceType?t("postgresql-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"HTTP"===e.modal.resourceType?t("http-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"TDENGINE"===e.modal.resourceType?t("t-dengine-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"SQLSERVER"===e.modal.resourceType?t("sqlserver-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"OPCUA"===e.modal.resourceType?t("opc-u-a-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"REDIS"===e.modal.resourceType?t("redis-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e()],1),t("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[t("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" 取消")]),t("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" 确定")])],1)],1)},n=[],l=(r("c740"),r("56fc")),c=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-form-model",{ref:"propForm",attrs:{layout:"vertical",model:e.properties,rules:e.rules}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"Topic",prop:"topic"}},[t("a-input",{attrs:{placeholder:"请输入Topic"},model:{value:e.properties.topic,callback:function(t){e.$set(e.properties,"topic",t)},expression:"properties.topic"}})],1)],1),"dest"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"消息保留",prop:"retained"}},[t("a-select",{attrs:{placeholder:"请选择是否消息保留"},model:{value:e.properties.retained,callback:function(t){e.$set(e.properties,"retained",t)},expression:"properties.retained"}},[t("a-select-option",{attrs:{value:!0}},[e._v("是")]),t("a-select-option",{attrs:{value:!1}},[e._v("否")])],1)],1)],1):e._e(),t("a-col",{attrs:{span:"dest"===e.type?12:24}},[t("a-form-model-item",{attrs:{label:"Qos",prop:"qos"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入Qos"},model:{value:e.properties.qos,callback:function(t){e.$set(e.properties,"qos",t)},expression:"properties.qos"}})],1)],1),"dest"===e.type?t("a-col",{staticClass:"payload",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"消息模板"}},[t("monaco-editor",{ref:"MonacoEditor"})],1)],1):e._e()],1)],1)},p=[],u=r("2200c"),d={components:{MonacoEditor:u["a"]},data:function(){return{properties:{qos:0,retained:!1},rules:{topic:[{required:!0,message:"请输入Topic",trigger:"blur"}],retained:[{required:!0,message:"请选择是否消息保留",trigger:"change"}],qos:[{required:!0,message:"请输入Qos",trigger:"blur"}]}}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=Object.assign({},this.properties,e),"dest"===this.type&&this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.payload)}))},get:function(e){"dest"===this.type&&(this.properties.payload=this.$refs.MonacoEditor.get());var t=this;this.$refs.propForm.validate((function(r){return r?e(!0,t.properties):e(!1)}))}}},m=d,f=r("2877"),h=Object(f["a"])(m,c,p,!1,null,null,null),g=h.exports,v=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-form-model",{ref:"propForm",attrs:{layout:"vertical",model:e.properties,rules:e.rules}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"Topic",prop:"topic"}},[t("a-input",{attrs:{placeholder:"请输入Topic"},model:{value:e.properties.topic,callback:function(t){e.$set(e.properties,"topic",t)},expression:"properties.topic"}})],1)],1),"source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"消费组",prop:"group"}},[t("a-input",{attrs:{placeholder:"请输入消费组"},model:{value:e.properties.group,callback:function(t){e.$set(e.properties,"group",t)},expression:"properties.group"}})],1)],1):e._e(),"dest"===e.type?t("a-col",{staticClass:"payload",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"消息模板"}},[t("monaco-editor",{ref:"MonacoEditor"})],1)],1):e._e()],1)],1)},y=[],b={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},rules:{topic:[{required:!0,message:"请输入Topic",trigger:"blur"}],group:[{required:!0,message:"请输入消费组",trigger:"blur"}]}}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=Object.assign({},this.properties,e),"dest"===this.type&&this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.payload)}))},get:function(e){"dest"===this.type&&(this.properties.payload=this.$refs.MonacoEditor.get());var t=this;this.$refs.propForm.validate((function(r){return r?e(!0,t.properties):e(!1)}))}}},_=b,k=Object(f["a"])(_,v,y,!1,null,null,null),S=k.exports,x=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-form-model",{ref:"propForm",attrs:{layout:"vertical",model:e.properties,rules:e.rules}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位",prop:"timeUnit"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟",prop:"initialDelay"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"查询频率",prop:"period"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入查询频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{staticClass:"sql",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"SQL模板",prop:"sql"}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{language:"sql"}})],1)],1)],1)],1)},M=[],$=r("995a"),w={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},timeUnitList:$["a"],rules:{sql:[{required:!0,validator:this.checkEditor,message:"请输入SQL模板",trigger:"blur"}],timeUnit:[{required:!0,message:"请选择时间单位",trigger:"change"}],initialDelay:[{required:!0,message:"请输入启动延迟",trigger:"blur"}],period:[{required:!0,message:"请输入请求频率",trigger:"blur"}]}}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=e,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.sql)}))},get:function(e){this.properties.sql=this.$refs.MonacoEditor.get();var t=this;this.$refs.propForm.validate((function(r){return r?e(!0,t.properties):e(!1)}))},checkEditor:function(e,t,r){var a=this.$refs.MonacoEditor.get();return a?r():r(new Error)}}},T=w,E=Object(f["a"])(T,x,M,!1,null,null,null),L=E.exports,R=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-form-model",{ref:"propForm",attrs:{layout:"vertical",model:e.properties,rules:e.rules}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位",prop:"timeUnit"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟",prop:"initialDelay"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"查询频率",prop:"period"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入查询频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{staticClass:"sql",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"SQL模板",prop:"sql"}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{language:"sql"}})],1)],1)],1)],1)},O=[],q={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},timeUnitList:$["a"],rules:{sql:[{required:!0,validator:this.checkEditor,message:"请输入SQL模板",trigger:"blur"}],timeUnit:[{required:!0,message:"请选择时间单位",trigger:"change"}],initialDelay:[{required:!0,message:"请输入启动延迟",trigger:"blur"}],period:[{required:!0,message:"请输入请求频率",trigger:"blur"}]}}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=e,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.sql)}))},get:function(e){this.properties.sql=this.$refs.MonacoEditor.get();var t=this;this.$refs.propForm.validate((function(r){return r?e(!0,t.properties):e(!1)}))},checkEditor:function(e,t,r){var a=this.$refs.MonacoEditor.get();return a?r():r(new Error)}}},U=q,D=Object(f["a"])(U,R,O,!1,null,null,null),I=D.exports,j=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-form-model",{ref:"propForm",attrs:{layout:"vertical",model:e.properties,rules:e.rules}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"路径",prop:"path"}},[t("a-input",{attrs:{placeholder:"请输入路径","addon-before":e.properties.url},model:{value:e.properties.path,callback:function(t){e.$set(e.properties,"path",t)},expression:"properties.path"}})],1)],1),t("a-col",{attrs:{span:"source"===e.type?12:24}},[t("a-form-model-item",{attrs:{label:"请求方式",prop:"method"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择请求方式"},model:{value:e.properties.method,callback:function(t){e.$set(e.properties,"method",t)},expression:"properties.method"}},e._l(e.methodList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r}},[e._v(e._s(r))])})),1)],1)],1),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"时间单位",prop:"timeUnit"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟",prop:"initialDelay"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"请求频率",prop:"period"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入请求频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{attrs:{span:24}},[t("http-headers-model",{ref:"HttpHeadersModel"})],1),t("a-col",{staticClass:"body",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"请求体"}},[t("monaco-editor",{ref:"MonacoEditor"})],1)],1)],1)],1)},N=[],P=function(){var e=this,t=e._self._c;return t("a-form-model-item",{attrs:{label:"请求头",prop:"paramContent"}},[t("div",{staticStyle:{"margin-top":"-30px",width:"100%","text-align":"right",height:"30px",color:"#000000","padding-top":"4px"}},[t("a",{on:{click:e.newItem}},[e._v("添加")])]),t("a-table",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"small"},scopedSlots:e._u([e._l(["name","value"],(function(r,a){return{key:r,fn:function(o,i){return[i.editable?t("a-input",{key:r,staticStyle:{margin:"-5px 0"},attrs:{value:o,placeholder:e.columns[a].title},on:{change:function(t){return e.handleChange(t.target.value,i.key,r)}}}):[e._v(e._s(o))]]}}})),{key:"action",fn:function(r,a){return[a.editable?[a.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此请求头？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(a.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(a.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此请求头？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},C=[],Q=r("2909"),F=r("5530"),A=r("b85c"),H=(r("b64b"),r("25f0"),r("4de4"),r("7db0"),r("159b"),{name:"HttpHeadersModel",data:function(){return{loading:!1,data:[],columns:[{title:"名称",dataIndex:"name",key:"name",width:"40%",scopedSlots:{customRender:"name"}},{title:"值",dataIndex:"value",key:"value",width:"40%",scopedSlots:{customRender:"value"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}]}},methods:{set:function(e){if(this.data=[],e)for(var t=Object.keys(e),r=1,a=0,o=t;a<o.length;a++){var i=o[a];this.data.push({key:r++,name:i,value:e[i],editable:!1,isNew:!1})}},get:function(){var e,t={},r=Object(A["a"])(this.data);try{for(r.s();!(e=r.n()).done;){var a=e.value;t[a.name]=a.value}}catch(o){r.e(o)}finally{r.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),name:"",value:"",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e}))},saveRow:function(e){this.loading=!0;var t=e.key,r=e.name,a=e.value;if(!r||!a)return this.loading=!1,void this.$message.error("填写不完整");var o=this.data.find((function(e){return e.key===t}));o.editable=!1,o.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(F["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,r){var a=Object(Q["a"])(this.data),o=a.find((function(e){return t===e.key}));o&&(o[r]=e,this.data=a)}}}),V=H,G=Object(f["a"])(V,P,C,!1,null,null,null),z=G.exports,J={components:{MonacoEditor:u["a"],HttpHeadersModel:z},data:function(){return{properties:{method:"GET",headers:{"Content-Type":"application/json"},body:""},methodList:["GET","POST","PUT","DELETE","HEAD","PATCH","OPTIONS","TRACE"],timeUnitList:$["a"],rules:{path:[{required:!0,message:"请输入路径",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],timeUnit:[{required:!0,message:"请选择时间单位",trigger:"change"}],initialDelay:[{required:!0,message:"请输入启动延迟",trigger:"blur"}],period:[{required:!0,message:"请输入请求频率",trigger:"blur"}]}}},props:{type:{type:String,default:void 0}},mounted:function(){var e=this;this.$nextTick((function(){e.$refs.HttpHeadersModel.set(e.properties.headers),e.$refs.MonacoEditor.set(e.properties.body)}))},methods:{set:function(e){var t=this;this.properties=Object.assign({},this.properties,e),this.$nextTick((function(){t.$refs.HttpHeadersModel.set(t.properties.headers),t.$refs.MonacoEditor.set(t.properties.body)}))},get:function(e){this.properties.headers=this.$refs.HttpHeadersModel.get(),this.properties.body=this.$refs.MonacoEditor.get();var t=this;this.$refs.propForm.validate((function(r){return r?e(!0,t.properties):e(!1)}))}}},K=J,W=Object(f["a"])(K,j,N,!1,null,null,null),Y=W.exports,B=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-form-model",{ref:"propForm",attrs:{layout:"vertical",model:e.properties,rules:e.rules}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位",prop:"timeUnit"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟",prop:"initialDelay"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"查询频率",prop:"period"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入查询频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{staticClass:"sql",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"SQL模板",prop:"sql"}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{language:"sql"}})],1)],1)],1)],1)},X=[],Z={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},timeUnitList:$["a"],rules:{sql:[{required:!0,validator:this.checkEditor,message:"请输入SQL模板",trigger:"blur"}],timeUnit:[{required:!0,message:"请选择时间单位",trigger:"change"}],initialDelay:[{required:!0,message:"请输入启动延迟",trigger:"blur"}],period:[{required:!0,message:"请输入请求频率",trigger:"blur"}]}}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=e,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.sql)}))},get:function(e){this.properties.sql=this.$refs.MonacoEditor.get();var t=this;this.$refs.propForm.validate((function(r){return r?e(!0,t.properties):e(!1)}))},checkEditor:function(e,t,r){var a=this.$refs.MonacoEditor.get();return a?r():r(new Error)}}},ee=Z,te=Object(f["a"])(ee,B,X,!1,null,null,null),re=te.exports,ae=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-form-model",{ref:"propForm",attrs:{layout:"vertical",model:e.properties,rules:e.rules}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位",prop:"timeUnit"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟",prop:"initialDelay"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"查询频率",prop:"period"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入查询频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{staticClass:"sql",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"SQL模板",prop:"sql"}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{language:"sql"}})],1)],1)],1)],1)},oe=[],ie={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},timeUnitList:$["a"],rules:{sql:[{required:!0,validator:this.checkEditor,message:"请输入SQL模板",trigger:"blur"}],timeUnit:[{required:!0,message:"请选择时间单位",trigger:"change"}],initialDelay:[{required:!0,message:"请输入启动延迟",trigger:"blur"}],period:[{required:!0,message:"请输入请求频率",trigger:"blur"}]}}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=e,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.sql)}))},get:function(e){this.properties.sql=this.$refs.MonacoEditor.get();var t=this;this.$refs.propForm.validate((function(r){return r?e(!0,t.properties):e(!1)}))},checkEditor:function(e,t,r){var a=this.$refs.MonacoEditor.get();return a?r():r(new Error)}}},se=ie,ne=Object(f["a"])(se,ae,oe,!1,null,null,null),le=ne.exports,ce=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-form-model",{ref:"propForm",attrs:{layout:"vertical",model:e.properties,rules:e.rules}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位",prop:"timeUnit"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟",prop:"initialDelay"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"读取频率",prop:"period"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入读取频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"读取点位",prop:"points"}},[t("opc-points-model",{ref:"OpcPointsModel"})],1)],1)],1)],1)},pe=[],ue=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"margin-top":"-30px",width:"100%","text-align":"right",height:"30px",color:"#000000","padding-top":"4px"}},[t("a",{on:{click:e.newItem}},[e._v("添加")])]),t("a-table",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"small"},scopedSlots:e._u([e._l(["namespace","tag"],(function(r,a){return{key:r,fn:function(o,i){return[i.editable?t("a-input",{key:r,staticStyle:{margin:"-5px 0"},attrs:{value:o,placeholder:e.columns[a].title},on:{change:function(t){return e.handleChange(t.target.value,i.key,r)}}}):[e._v(e._s(o))]]}}})),{key:"action",fn:function(r,a){return[a.editable?[a.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(a.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(a.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},de=[],me={name:"OpcPointsModel",data:function(){return{loading:!1,data:[],columns:[{title:"命名空间",dataIndex:"namespace",key:"namespace",width:"40%",scopedSlots:{customRender:"namespace"}},{title:"标识",dataIndex:"tag",key:"tag",width:"40%",scopedSlots:{customRender:"tag"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}]}},methods:{set:function(e){if(this.data=[],e){var t,r=1,a=Object(A["a"])(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;this.data.push({key:r++,namespace:o.namespace,tag:o.tag,editable:!1,isNew:!1})}}catch(i){a.e(i)}finally{a.f()}}},get:function(){var e,t=[],r=Object(A["a"])(this.data);try{for(r.s();!(e=r.n()).done;){var a=e.value;t.push({namespace:a.namespace,tag:a.tag})}}catch(o){r.e(o)}finally{r.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),namespace:0,tag:"",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e}))},saveRow:function(e){this.loading=!0;var t=e.key,r=e.namespace,a=e.tag;if(!r||!a)return this.loading=!1,void this.$message.error("填写不完整");var o=this.data.find((function(e){return e.key===t}));o.editable=!1,o.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(F["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,r){var a=Object(Q["a"])(this.data),o=a.find((function(e){return t===e.key}));o&&(o[r]=e,this.data=a)}}},fe=me,he=Object(f["a"])(fe,ue,de,!1,null,null,null),ge=he.exports,ve={components:{OpcPointsModel:ge},data:function(){return{properties:{points:[]},timeUnitList:$["a"],rules:{points:[{required:!0,validator:this.checkPoints,message:"请配置读取点位",trigger:"blur"}],timeUnit:[{required:!0,message:"请选择时间单位",trigger:"change"}],initialDelay:[{required:!0,message:"请输入启动延迟",trigger:"blur"}],period:[{required:!0,message:"请输入请求频率",trigger:"blur"}]}}},props:{type:{type:String,default:void 0}},mounted:function(){},methods:{set:function(e){var t=this;this.properties=Object.assign({},this.properties,e),this.$nextTick((function(){t.$refs.OpcPointsModel.set(t.properties.points)}))},get:function(e){this.properties.points=this.$refs.OpcPointsModel.get();var t=this;this.$refs.propForm.validate((function(r){return r?e(!0,t.properties):e(!1)}))},checkPoints:function(e,t,r){var a=this.$refs.OpcPointsModel.get();return a&&0!==a.length?r():r(new Error)}}},ye=ve,be=Object(f["a"])(ye,ce,pe,!1,null,null,null),_e=be.exports,ke=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-form-model",{ref:"propForm",attrs:{layout:"vertical",model:e.properties,rules:e.rules}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位",prop:"timeUnit"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟",prop:"initialDelay"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"查询频率",prop:"period"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入查询频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{staticClass:"sql",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"命令模板",prop:"command"}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{language:"redis"}})],1)],1)],1)],1)},Se=[],xe={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},timeUnitList:$["a"],rules:{command:[{required:!0,validator:this.checkEditor,message:"请输入命令模板",trigger:"blur"}],timeUnit:[{required:!0,message:"请选择时间单位",trigger:"change"}],initialDelay:[{required:!0,message:"请输入启动延迟",trigger:"blur"}],period:[{required:!0,message:"请输入请求频率",trigger:"blur"}]}}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=e,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.command)}))},get:function(e){this.properties.command=this.$refs.MonacoEditor.get();var t=this;this.$refs.propForm.validate((function(r){return r?e(!0,t.properties):e(!1)}))},checkEditor:function(e,t,r){var a=this.$refs.MonacoEditor.get();return a?r():r(new Error)}}},Me=xe,$e=Object(f["a"])(Me,ke,Se,!1,null,null,null),we=$e.exports,Te={name:"ResourceModel",components:{MqttProperties:g,KafkaProperties:S,MysqlProperties:L,PostgresqlProperties:I,HttpProperties:Y,TDengineProperties:re,SqlserverProperties:le,OpcUAProperties:_e,RedisProperties:we},data:function(){return{title:"操作",visible:!1,confirmLoading:!1,modal:{},url:{resourceList:"/api/resource/list"},rules:{resourceType:[{required:!0,message:"请选择资源类型",trigger:"change"}],resourceId:[{required:!0,message:"请选择资源",trigger:"change"}]},resourceList:[],resourceTypeList:[],resourceMode:null,resourceIndex:-1}},mounted:function(){},methods:{add:function(e){this.edit(e,{},-1)},edit:function(e,t,r){var a=this;this.resourceMode=e,this.resourceIndex=r,this.modal=JSON.parse(JSON.stringify(t)),this.resourceTypeList=Object(l["b"])(e),this.visible=!0,this.$nextTick((function(){a.modal.resourceType&&(a.$refs.PropertiesModal.set(a.modal.properties),a.listResource(a.modal.resourceType))}))},listResource:function(e){var t=this;Object(i["c"])(this.url.resourceList,{resourceType:e}).then((function(e){t.resourceList=e.data}))},onClose:function(){this.visible=!1},handleOk:function(){var e=this,t=this;this.$refs.ruleForm.validate((function(r){if(!r)return!1;t.$refs.PropertiesModal.get((function(r,a){if(!r)return!1;t.confirmLoading=!0,t.modal.properties=a,t.resourceIndex>=0?t.$emit("update",e.resourceMode,e.modal,e.resourceIndex):t.$emit("add",e.resourceMode,e.modal),t.confirmLoading=!1,t.visible=!1}))}))},filterOption:function(e,t){return!!t.componentOptions.children[0].text&&t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},resourceTypeChange:function(e){this.modal={resourceType:e},this.listResource(e)},resourceChange:function(e){var t=this,r=this.resourceList.findIndex((function(t){return t.resourceId===e}));this.modal=this.resourceList[r],this.$nextTick((function(){t.modal.resourceType&&t.$refs.PropertiesModal.set(t.modal.properties)}))}}},Ee=Te,Le=Object(f["a"])(Ee,s,n,!1,null,"9a6c52b8",null),Re=Le.exports,Oe=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{confirmLoading:e.confirmLoading,title:"脚本",width:700,visible:e.visible,footer:null,bodyStyle:{padding:0}},on:{cancel:e.onClose}},[t("div",{staticStyle:{"min-height":"400px"}},[t("a-table",{attrs:{columns:e.columns,"data-source":e.scriptList,size:"small",pagination:!1},scopedSlots:e._u([{key:"action",fn:function(r,a){return t("span",{},[t("a",{on:{click:function(t){return e.select(a)}}},[e._v("选择")])])}}])})],1)])},qe=[],Ue={name:"ScriptSelectModel",components:{},data:function(){return{visible:!1,confirmLoading:!1,url:{script:"/api/script/list"},columns:[{title:"名称",align:"center",dataIndex:"scriptName",width:"40%"},{title:"最后修改",align:"center",dataIndex:"updateTime",width:"40%"},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],scriptList:[]}},methods:{show:function(){this.getScriptList(),this.visible=!0},onClose:function(){this.visible=!1},getScriptList:function(){var e=this;Object(i["c"])(this.url.script,{}).then((function(t){200===t.code&&(e.scriptList=t.data)}))},select:function(e){this.$emit("select",e),this.visible=!1}}},De=Ue,Ie=Object(f["a"])(De,Oe,qe,!1,null,"7c3ccf4d",null),je=Ie.exports,Ne=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{"body-style":{minHeight:"260px"},bordered:!1}},[t("a-row",{staticStyle:{padding:"0"}},[t("a-col",{staticClass:"title",attrs:{span:12}},[e._v("环境变量")]),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[t("a",{on:{click:e.newItem}},[e._v("添加")])])],1),t("a-table",{attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"middle"},scopedSlots:e._u([e._l(["name","value"],(function(r,a){return{key:r,fn:function(o,i){return[i.editable?t("a-input",{key:r,staticStyle:{margin:"-5px 0"},attrs:{value:o,placeholder:e.columns[a].title},on:{change:function(t){return e.handleChange(t.target.value,i.key,r)}}}):[e._v(e._s(o))]]}}})),{key:"action",fn:function(r,a){return[a.editable?[a.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此变量？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(a.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(a.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此变量？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},Pe=[],Ce={name:"VariablesModel",data:function(){return{loading:!1,data:[],columns:[{title:"变量名",dataIndex:"name",key:"name",width:"40%",scopedSlots:{customRender:"name"}},{title:"初始值",dataIndex:"value",key:"value",width:"40%",scopedSlots:{customRender:"value"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}]}},methods:{set:function(e){if(this.data=[],e)for(var t=Object.keys(e),r=1,a=0,o=t;a<o.length;a++){var i=o[a];this.data.push({key:r++,name:i,value:e[i],editable:!1,isNew:!1})}},get:function(){var e,t={},r=Object(A["a"])(this.data);try{for(r.s();!(e=r.n()).done;){var a=e.value;t[a.name]=a.value}}catch(o){r.e(o)}finally{r.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),name:"",value:"",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e}))},saveRow:function(e){this.loading=!0;var t=e.key,r=e.name,a=e.value;if(!r||!a)return this.loading=!1,void this.$message.error("填写不完整");var o=this.data.find((function(e){return e.key===t}));o.editable=!1,o.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(F["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,r){var a=Object(Q["a"])(this.data),o=a.find((function(e){return t===e.key}));o&&(o[r]=e,this.data=a)}}},Qe=Ce,Fe=(r("b12c"),Object(f["a"])(Qe,Ne,Pe,!1,null,null,null)),Ae=Fe.exports,He=r("8e45"),Ve={components:{ResourceModel:Re,ScriptSelectModel:je,VariablesModel:Ae,MonacoEditor:u["a"]},data:function(){return{modal:{sourceResource:void 0,destResourceList:[],transformMode:"WITHOUT",ignoreNullValue:!1},url:{add:"/api/rule/add",update:"/api/rule/update",info:"/api/rule/info",plugin:"/api/plugin/list",resource:"/api/resource/info"},rules:{ruleName:[{required:!0,message:"请输入规则名称",trigger:"blur"}],transformMode:[{required:!0,message:"请选择转换方式",trigger:"change"}],ignoreNullValue:[{required:!0,message:"请选择是否忽略空值",trigger:"change"}]},resourceTypeMap:l["c"],options:{mode:{name:"text/javascript",json:!0},height:150,lineNumbers:!0,tabSize:2,theme:"base16-light",line:!0,autoCloseTags:!0,lineWrapping:!0,styleActiveLine:!0,extraKeys:{tab:"autocomplete"},hintOptions:{tables:{}}},pluginList:[],transformModeList:He["a"],defaultScript:"/**\n* 方法名transform不可修改,入参：data Object 源数据,出参：data Object 目标数据\n*/\nfunction transform(data) {\n    return data;\n}"}},mounted:function(){var e=this,t=this.$route.params.ruleId;"new"!==t&&(this.ruleId=t,Object(i["b"])(this.url.info,{ruleId:this.ruleId}).then((function(t){var r=t.data;r&&(e.modal=t.data,e.$nextTick((function(){e.$refs.VariablesModel.set(e.modal.variables),"SCRIPT"===e.modal.transformMode&&e.$refs.MonacoEditor.set(e.modal.script)})))}))),this.getPluginList()},methods:{getDetails:function(e){return Object(l["a"])(e,"rule")},addResource:function(e){this.$refs.ResourceModel.add(e)},editResource:function(e,t,r){this.$refs.ResourceModel.edit(e,t,r)},deleteResource:function(e,t){"dest"===e?this.modal.destResourceList.splice(t,1):"source"===e&&(this.modal.sourceResource=null)},freshResource:function(e,t,r){var a=this;Object(i["b"])(this.url.resource,{resourceId:t.resourceId}).then((function(o){if(200===o.code){var i=Object.assign({},t.properties,o.data.properties),s=Object.assign({},t,o.data);s.properties=i,a.handleUpdateResource(e,s,r),a.$message.success("刷新成功")}else a.$message.error("刷新失败")}))},handleAddResource:function(e,t){"dest"===e?this.modal.destResourceList.push(t):"source"===e&&(this.modal.sourceResource=t)},handleUpdateResource:function(e,t,r){"dest"===e?this.$set(this.modal.destResourceList,r,t):"source"===e&&(this.modal.sourceResource=t)},transformModeChange:function(e){var t=this;"SCRIPT"!==e||this.modal.script?this.modal.script="":this.modal.script=this.defaultScript,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.modal.script)}))},saveRule:function(){var e=this;if(this.modal.sourceResource&&this.modal.sourceResource.resourceId)if(this.modal.destResourceList&&0!==this.modal.destResourceList.length){var t=this;this.$refs.ruleForm.validate((function(r){if(!r)return!1;t.confirmLoading=!0;var a,o=JSON.parse(JSON.stringify(e.modal));o.variables=e.$refs.VariablesModel.get(),"SCRIPT"===e.modal.transformMode?o.script=e.$refs.MonacoEditor.get():delete o.script,"PLUGIN"!==e.modal.transformMode&&delete o.pluginId,a=e.ruleId?Object(i["d"])(e.url.update,o):Object(i["c"])(e.url.add,o),a.then((function(e){200===e.code?(t.$message.success("保存成功"),t.onClose()):t.$message.error("保存失败")})).finally((function(){t.confirmLoading=!1,t.onClose()}))}))}else this.$message.error("请至少选择一个目标资源");else this.$message.error("请绑定数据源")},selectScript:function(){this.$refs.ScriptSelectModel.show()},handleSelectedScript:function(e){this.modal.script=e.scriptContent,this.$refs.MonacoEditor.set(this.modal.script)},getPluginList:function(){var e=this;Object(i["c"])(this.url.plugin,{}).then((function(t){200===t.code&&(e.pluginList=t.data)}))},onClose:function(){this.$router.push({name:"ruleList"})}}},Ge=Ve,ze=(r("5c42"),Object(f["a"])(Ge,a,o,!1,null,null,null));t["default"]=ze.exports},ff34:function(e,t,r){}}]);