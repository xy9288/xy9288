(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fe74caf"],{"12cc":function(e,t,r){},2909:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r("6b75");function o(e){if(Array.isArray(e))return Object(a["a"])(e)}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("a630");function i(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var n=r("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return o(e)||i(e)||Object(n["a"])(e)||s()}},"56fc":function(e,t,r){"use strict";r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return p})),r.d(t,"a",(function(){return u}));var a=r("b85c"),o=(r("99af"),r("b0c0"),r("995a")),i="all",n="source",s={MQTT:{name:"MQTT Broker",type:i,details:{resource:{name:"资源地址",format:function(e){return e.properties.url}},rule:[{name:"资源地址",format:function(e){return e.properties.url}},{name:"Topic",format:function(e){return e.properties.topic}}]}},KAFKA:{name:"Kafka",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},{name:"Topic",format:function(e){return e.properties.topic}}]}},MYSQL:{name:"MySQL",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",format:function(e){return e.properties.sql}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"查询频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},POSTGRESQL:{name:"PostgreSQL",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",format:function(e){return e.properties.sql}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"查询频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},SQLSERVER:{name:"SQL Server",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",format:function(e){return e.properties.sql}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"查询频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},TDENGINE:{name:"TDengine",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.ip,":").concat(e.properties.port,"/").concat(e.properties.databaseName)}},{name:"SQL模板",format:function(e){return e.properties.sql}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"查询频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},HTTP:{name:"HTTP",type:i,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},rule:[{name:"请求路径",format:function(e){return"".concat(e.properties.url).concat(e.properties.path)}},{name:"请求方式",format:function(e){return"".concat(e.properties.method)}},{name:"启动延迟",format:function(e){return e.properties.initialDelay?"".concat(e.properties.initialDelay).concat(o["b"][e.properties.timeUnit]):void 0}},{name:"调用频率",format:function(e){return e.properties.period?"".concat(e.properties.period).concat(o["b"][e.properties.timeUnit]):void 0}}]}},OPCUA:{name:"OPC UA",type:n,details:{resource:{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},rule:[{name:"资源地址",format:function(e){return"".concat(e.properties.url)}},{name:"读取点位",format:function(e){return"".concat(e.properties.points?e.properties.points.length:0)}}]}}};function l(){var e={};for(var t in s)e[t]=s[t].name;return e}var c=l();function p(e){var t=[];for(var r in s){var a=s[r].type;if(!e||a===i||a===e){var o={name:s[r].name,code:r,type:a};t.push(o)}}return t}function u(e,t){if(!e||!e.resourceType)return"resource"===t?{name:"",value:""}:[{name:"",value:""}];var r=s[e.resourceType],o=r.details[t];if("resource"===t){var i=o.format(e);return i?{name:o.name,value:i}:{name:"",value:""}}var n,l=[],c=Object(a["a"])(o);try{for(c.s();!(n=c.n()).done;){var p=n.value,u=p.format(e);u&&l.push({name:p.name,value:u})}}catch(d){c.e(d)}finally{c.f()}return l}},"8e45":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var a={WITHOUT:"无解析透传",SCRIPT:"JavaScript脚本",PLUGIN:"Java插件(暂不支持)"};function o(){var e=[];for(var t in a)e.push({name:a[t],value:t});return e}var i=o()},"995a":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var a={SECONDS:"秒",MINUTES:"分",HOURS:"时",DAYS:"天"};function o(){var e=[];for(var t in a)e.push({name:a[t],value:t});return e}var i=o()},b12c:function(e,t,r){"use strict";r("ff34")},d45d:function(e,t,r){"use strict";r.r(t);r("a4d3"),r("e01a"),r("b0c0");var a=function(){var e=this,t=e._self._c;return t("div",[t("a-form-model",{ref:"ruleForm",attrs:{model:e.modal,layout:"vertical",rules:e.rules}},[t("a-card",{staticStyle:{"margin-bottom":"20px"},attrs:{bordered:!1,"body-style":{padding:"17px 24px"}}},[t("a-row",[t("a-col",{staticStyle:{"font-size":"16px","font-weight":"bold",color:"rgba(0, 0, 0, 0.85)","padding-top":"4px"},attrs:{span:12}},[e._v(" "+e._s(e.modal.ruleId?"编辑":"新建")+"规则 ")]),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[t("a-button",{staticStyle:{width:"90px","margin-right":"8px"},on:{click:e.onClose}},[e._v(" 取消")]),t("a-button",{staticStyle:{width:"90px"},attrs:{type:"primary"},on:{click:e.saveRule}},[e._v(" 保存")])],1)],1)],1),t("a-card",{staticStyle:{"margin-bottom":"20px"},attrs:{"body-style":{paddingBottom:0},bordered:!1}},[t("a-row",{attrs:{gutter:20}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"名称",prop:"ruleName"}},[t("a-input",{attrs:{placeholder:"请输入规则名称"},model:{value:e.modal.ruleName,callback:function(t){e.$set(e.modal,"ruleName",t)},expression:"modal.ruleName"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"备注"}},[t("a-input",{attrs:{placeholder:"请输入备注"},model:{value:e.modal.description,callback:function(t){e.$set(e.modal,"description",t)},expression:"modal.description"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"解析方式",prop:"analysisMode"}},[t("a-select",{attrs:{placeholder:"请选择解析方式"},on:{change:e.analysisModeChange},model:{value:e.modal.analysisMode,callback:function(t){e.$set(e.modal,"analysisMode",t)},expression:"modal.analysisMode"}},e._l(e.analysisModeList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(" "+e._s(r.name)+" ")])})),1)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"忽略空值",prop:"ignoreNullValue"}},[t("a-select",{attrs:{placeholder:"请选择是否忽略空值"},model:{value:e.modal.ignoreNullValue,callback:function(t){e.$set(e.modal,"ignoreNullValue",t)},expression:"modal.ignoreNullValue"}},[t("a-select-option",{attrs:{value:!0}},[e._v("是")]),t("a-select-option",{attrs:{value:!1}},[e._v("否")])],1)],1)],1)],1)],1),t("a-card",{staticStyle:{"margin-bottom":"20px"},attrs:{bordered:!1}},[t("div",{staticClass:"title"},[e._v("数据源")]),e.modal.sourceResource?t("a-row",{staticStyle:{"background-color":"#f6f6f6",padding:"15px 10px 0 15px"}},[t("a-col",{attrs:{span:18}},[t("a-descriptions",{attrs:{column:2}},[t("a-descriptions-item",{attrs:{label:"资源名称"}},[e._v(" "+e._s(e.modal.sourceResource.resourceName)+" ")]),t("a-descriptions-item",{attrs:{label:"资源类型"}},[e._v(" "+e._s(e.resourceTypeMap[e.modal.sourceResource.resourceType])+" ")]),e._l(e.getDetails(e.modal.sourceResource),(function(r,a){return t("a-descriptions-item",{key:a,attrs:{label:r.name}},[e._v(" "+e._s(r.value)+" ")])}))],2)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("a",{on:{click:function(t){return e.editResource("source",e.modal.sourceResource)}}},[e._v("配置")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"移除此资源?"},on:{confirm:function(){return e.deleteResource("source")}}},[t("a",{attrs:{href:"javascript:;"}},[e._v("移除")])])],1)],1):e._e(),e.modal.sourceResource?e._e():t("a-button",{on:{click:function(t){return e.addResource("source")}}},[e._v(" 绑定数据源")])],1),t("a-card",{staticStyle:{"margin-bottom":"20px"},attrs:{bordered:!1}},[t("div",{staticClass:"title"},[e._v("目标资源")]),e.modal.destResourceList.length>0?t("a-list",{attrs:{grid:{gutter:16,xs:1,sm:1,md:1,lg:1,xl:1,xxl:1},"data-source":e.modal.destResourceList},scopedSlots:e._u([{key:"renderItem",fn:function(r,a){return t("a-list-item",{},[t("a-row",{staticStyle:{"background-color":"#f6f6f6",padding:"15px 10px 0 15px"}},[t("a-col",{attrs:{span:18}},[t("a-descriptions",{attrs:{column:2}},[t("a-descriptions-item",{attrs:{label:"资源名称"}},[e._v(" "+e._s(r.resourceName)+" ")]),t("a-descriptions-item",{attrs:{label:"资源类型"}},[e._v(" "+e._s(e.resourceTypeMap[r.resourceType])+" ")]),e._l(e.getDetails(r),(function(r,a){return t("a-descriptions-item",{key:a,attrs:{label:r.name}},[e._v(" "+e._s(r.value)+" ")])}))],2)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("a",{on:{click:function(t){return e.editResource("dest",r,a)}}},[e._v("配置")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"移除此资源?"},on:{confirm:function(){return e.deleteResource("dest",a)}}},[t("a",{attrs:{href:"javascript:;"}},[e._v("移除")])])],1)],1)],1)}}],null,!1,2999157465)}):e._e(),t("a-button",{on:{click:function(t){return e.addResource("dest")}}},[e._v(" 添加目标资源")])],1),"WITHOUT"!==e.modal.analysisMode?t("a-card",{staticStyle:{"margin-bottom":"20px"},attrs:{bordered:!1}},[t("a-row",{staticStyle:{padding:"0"}},[t("a-col",{staticClass:"title",attrs:{span:12}},[e._v("数据解析")]),"SCRIPT"===e.modal.analysisMode?t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[t("a",{on:{click:e.selectScript}},[e._v("选择脚本")])]):e._e()],1),t("a-row",{attrs:{gutter:20}},["SCRIPT"===e.modal.analysisMode?t("a-col",{attrs:{span:24}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{height:"300px",minimap:!0}})],1):e._e(),t("a-col",{attrs:{span:24}},["PLUGIN"===e.modal.analysisMode?t("a-form-model-item",{attrs:{label:"Jar包地址",prop:"script"}},[t("a-input",{attrs:{placeholder:"请输入Jar包地址"}})],1):e._e()],1),t("a-col",{attrs:{span:24}},["PLUGIN"===e.modal.analysisMode?t("a-form-model-item",{attrs:{label:"解析类名",prop:"script"}},[t("a-input",{attrs:{placeholder:"请输入解析类名"}})],1):e._e()],1)],1)],1):e._e(),t("variables-model",{ref:"VariablesModel"})],1),t("resource-model",{ref:"ResourceModel",on:{update:e.handleUpdateResource,add:e.handleAddResource}}),t("script-select-model",{ref:"ScriptSelectModel",on:{select:e.handleSelectedScript}})],1)},o=[],i=(r("a434"),r("d3b7"),r("0fea")),n=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{confirmLoading:e.confirmLoading,title:"source"===e.resourceMode?"源数据":"目标资源",width:550,visible:e.visible,destroyOnClose:!0},on:{cancel:e.onClose}},[t("a-form-model",{ref:"ruleForm",attrs:{model:e.modal,layout:"vertical",rules:e.rules}},[t("a-form-model-item",{attrs:{label:"类型",prop:"resourceType"}},[t("a-select",{attrs:{placeholder:"请选择资源类型"},on:{change:e.resourceTypeChange},model:{value:e.modal.resourceType,callback:function(t){e.$set(e.modal,"resourceType",t)},expression:"modal.resourceType"}},e._l(e.resourceTypeList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.code}},[e._v(e._s(r.name)+" ")])})),1)],1),t("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.modal.resourceType,expression:"modal.resourceType"}],attrs:{label:"资源",prop:"resourceId"}},[t("a-select",{attrs:{placeholder:"请选择资源"},on:{change:e.resourceChange},model:{value:e.modal.resourceId,callback:function(t){e.$set(e.modal,"resourceId",t)},expression:"modal.resourceId"}},e._l(e.resourceList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.resourceId}},[e._v(" "+e._s(r.resourceName)+" ")])})),1)],1),"MQTT"===e.modal.resourceType?t("mqtt-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"KAFKA"===e.modal.resourceType?t("kafka-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"MYSQL"===e.modal.resourceType?t("MysqlProperties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"POSTGRESQL"===e.modal.resourceType?t("postgresql-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"HTTP"===e.modal.resourceType?t("http-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"TDENGINE"===e.modal.resourceType?t("t-dengine-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"SQLSERVER"===e.modal.resourceType?t("sqlserver-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e(),"OPCUA"===e.modal.resourceType?t("opc-u-a-properties",{ref:"PropertiesModal",attrs:{type:e.resourceMode}}):e._e()],1),t("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[t("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" 取消")]),t("a-button",{attrs:{type:"primary"},on:{click:e.handleOk}},[e._v(" 确定")])],1)],1)},s=[],l=(r("c740"),r("56fc")),c=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:20}},[t("a-form-model",{attrs:{layout:"vertical",model:e.properties}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"Topic"}},[t("a-input",{attrs:{placeholder:"请输入Topic"},model:{value:e.properties.topic,callback:function(t){e.$set(e.properties,"topic",t)},expression:"properties.topic"}})],1)],1),"dest"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"消息保留"}},[t("a-select",{attrs:{placeholder:"请选择是否消息保留"},model:{value:e.properties.retained,callback:function(t){e.$set(e.properties,"retained",t)},expression:"properties.retained"}},[t("a-select-option",{attrs:{value:!0}},[e._v("是")]),t("a-select-option",{attrs:{value:!1}},[e._v("否")])],1)],1)],1):e._e(),t("a-col",{attrs:{span:"dest"===e.type?12:24}},[t("a-form-model-item",{attrs:{label:"Qos"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入Qos"},model:{value:e.properties.qos,callback:function(t){e.$set(e.properties,"qos",t)},expression:"properties.qos"}})],1)],1),"dest"===e.type?t("a-col",{staticClass:"payload",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"消息模板"}},[t("monaco-editor",{ref:"MonacoEditor"})],1)],1):e._e()],1)],1)},p=[],u=r("2200c"),d={components:{MonacoEditor:u["a"]},data:function(){return{properties:{qos:0,retained:!1}}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=Object.assign({},this.properties,e),"dest"===this.type&&this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.payload)}))},get:function(){return"dest"===this.type&&(this.properties.payload=this.$refs.MonacoEditor.get()),this.properties}}},m=d,f=r("2877"),h=Object(f["a"])(m,c,p,!1,null,null,null),v=h.exports,y=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:20}},[t("a-form-model",{attrs:{layout:"vertical",model:e.properties}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"Topic"}},[t("a-input",{attrs:{placeholder:"请输入Topic"},model:{value:e.properties.topic,callback:function(t){e.$set(e.properties,"topic",t)},expression:"properties.topic"}})],1)],1),"source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"消费组"}},[t("a-input",{attrs:{placeholder:"请输入消费组"},model:{value:e.properties.group,callback:function(t){e.$set(e.properties,"group",t)},expression:"properties.group"}})],1)],1):e._e(),"dest"===e.type?t("a-col",{staticClass:"payload",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"消息模板"}},[t("monaco-editor",{ref:"MonacoEditor"})],1)],1):e._e()],1)],1)},b=[],g={components:{MonacoEditor:u["a"]},data:function(){return{properties:{}}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=Object.assign({},this.properties,e),"dest"===this.type&&this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.payload)}))},get:function(){return"dest"===this.type&&(this.properties.payload=this.$refs.MonacoEditor.get()),this.properties}}},_=g,k=Object(f["a"])(_,y,b,!1,null,null,null),S=k.exports,x=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:20}},[t("a-form-model",{attrs:{layout:"vertical",model:e.properties}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"查询频率"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入查询频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{staticClass:"sql",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"SQL模板"}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{language:"sql"}})],1)],1)],1)],1)},M=[],w=r("995a"),T={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},timeUnitList:w["a"]}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=e,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.sql)}))},get:function(){return this.properties.sql=this.$refs.MonacoEditor.get(),this.properties}}},$=T,O=Object(f["a"])($,x,M,!1,null,null,null),L=O.exports,R=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:20}},[t("a-form-model",{attrs:{layout:"vertical",model:e.properties}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"查询频率"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入查询频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{staticClass:"sql",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"SQL模板"}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{language:"sql"}})],1)],1)],1)],1)},E=[],U={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},timeUnitList:w["a"]}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=e,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.sql)}))},get:function(){return this.properties.sql=this.$refs.MonacoEditor.get(),this.properties}}},I=U,j=Object(f["a"])(I,R,E,!1,null,null,null),N=j.exports,C=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:20}},[t("a-form-model",{attrs:{layout:"vertical",model:e.properties}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"路径"}},[t("a-input",{attrs:{placeholder:"请输入路径","addon-before":e.properties.url},model:{value:e.properties.path,callback:function(t){e.$set(e.properties,"path",t)},expression:"properties.path"}})],1)],1),t("a-col",{attrs:{span:"source"===e.type?12:24}},[t("a-form-model-item",{attrs:{label:"请求方式"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择请求方式"},model:{value:e.properties.method,callback:function(t){e.$set(e.properties,"method",t)},expression:"properties.method"}},e._l(e.methodList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r}},[e._v(e._s(r))])})),1)],1)],1),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"时间单位"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"请求频率"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入请求频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{attrs:{span:24}},[t("http-headers-model",{ref:"HttpHeadersModel"})],1),t("a-col",{staticClass:"body",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"请求体"}},[t("monaco-editor",{ref:"MonacoEditor"})],1)],1)],1)],1)},D=[],P=function(){var e=this,t=e._self._c;return t("a-form-model-item",{attrs:{label:"请求头",prop:"paramContent"}},[t("div",{staticStyle:{"margin-top":"-30px",width:"100%","text-align":"right",height:"30px",color:"#000000","padding-top":"4px"}},[t("a",{on:{click:e.newItem}},[e._v("添加")])]),t("a-table",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"small"},scopedSlots:e._u([e._l(["name","value"],(function(r,a){return{key:r,fn:function(o,i){return[i.editable?t("a-input",{key:r,staticStyle:{margin:"-5px 0"},attrs:{value:o,placeholder:e.columns[a].title},on:{change:function(t){return e.handleChange(t.target.value,i.key,r)}}}):[e._v(e._s(o))]]}}})),{key:"action",fn:function(r,a){return[a.editable?[a.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此请求头？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(a.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(a.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此请求头？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},q=[],H=r("2909"),Q=r("5530"),A=r("b85c"),V=(r("b64b"),r("25f0"),r("4de4"),r("7db0"),r("159b"),{name:"HttpHeadersModel",data:function(){return{loading:!1,data:[],columns:[{title:"名称",dataIndex:"name",key:"name",width:"40%",scopedSlots:{customRender:"name"}},{title:"值",dataIndex:"value",key:"value",width:"40%",scopedSlots:{customRender:"value"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}]}},methods:{set:function(e){if(this.data=[],e)for(var t=Object.keys(e),r=1,a=0,o=t;a<o.length;a++){var i=o[a];this.data.push({key:r++,name:i,value:e[i],editable:!1,isNew:!1})}},get:function(){var e,t={},r=Object(A["a"])(this.data);try{for(r.s();!(e=r.n()).done;){var a=e.value;t[a.name]=a.value}}catch(o){r.e(o)}finally{r.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),name:"",value:"",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e}))},saveRow:function(e){this.loading=!0;var t=e.key,r=e.name,a=e.value;if(!r||!a)return this.loading=!1,void this.$message.error("填写不完整");var o=this.data.find((function(e){return e.key===t}));o.editable=!1,o.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(Q["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,r){var a=Object(H["a"])(this.data),o=a.find((function(e){return t===e.key}));o&&(o[r]=e,this.data=a)}}}),J=V,G=Object(f["a"])(J,P,q,!1,null,null,null),z=G.exports,K={components:{MonacoEditor:u["a"],HttpHeadersModel:z},data:function(){return{properties:{method:"GET",headers:{"Content-Type":"application/json"},body:""},methodList:["GET","POST","PUT","DELETE","HEAD","PATCH","OPTIONS","TRACE"],timeUnitList:w["a"]}},props:{type:{type:String,default:void 0}},mounted:function(){var e=this;this.$nextTick((function(){e.$refs.HttpHeadersModel.set(e.properties.headers),e.$refs.MonacoEditor.set(e.properties.body)}))},methods:{set:function(e){var t=this;this.properties=Object.assign({},this.properties,e),this.$nextTick((function(){t.$refs.HttpHeadersModel.set(t.properties.headers),t.$refs.MonacoEditor.set(t.properties.body)}))},get:function(){return this.properties.headers=this.$refs.HttpHeadersModel.get(),this.properties.body=this.$refs.MonacoEditor.get(),this.properties}}},F=K,W=Object(f["a"])(F,C,D,!1,null,null,null),Y=W.exports,B=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:20}},[t("a-form-model",{attrs:{layout:"vertical",model:e.properties}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"查询频率"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入查询频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{staticClass:"sql",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"SQL模板"}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{language:"sql"}})],1)],1)],1)],1)},X=[],Z={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},timeUnitList:w["a"]}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=e,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.sql)}))},get:function(){return this.properties.sql=this.$refs.MonacoEditor.get(),this.properties}}},ee=Z,te=Object(f["a"])(ee,B,X,!1,null,null,null),re=te.exports,ae=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:20}},[t("a-form-model",{attrs:{layout:"vertical",model:e.properties}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"查询频率"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入查询频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{staticClass:"sql",attrs:{span:24}},[t("a-form-model-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"SQL模板"}},[t("monaco-editor",{ref:"MonacoEditor",attrs:{language:"sql"}})],1)],1)],1)],1)},oe=[],ie={components:{MonacoEditor:u["a"]},data:function(){return{properties:{},timeUnitList:w["a"]}},props:{type:{type:String,default:void 0}},methods:{set:function(e){var t=this;this.properties=e,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.properties.sql)}))},get:function(){return this.properties.sql=this.$refs.MonacoEditor.get(),this.properties}}},ne=ie,se=Object(f["a"])(ne,ae,oe,!1,null,null,null),le=se.exports,ce=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:20}},[t("a-form-model",{attrs:{layout:"vertical",model:e.properties}},["source"===e.type?t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"时间单位"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择时间单位"},model:{value:e.properties.timeUnit,callback:function(t){e.$set(e.properties,"timeUnit",t)},expression:"properties.timeUnit"}},e._l(e.timeUnitList,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[e._v(e._s(r.name)+" ")])})),1)],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"启动延迟"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入启动延迟"},model:{value:e.properties.initialDelay,callback:function(t){e.$set(e.properties,"initialDelay",t)},expression:"properties.initialDelay"}})],1)],1):e._e(),"source"===e.type?t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"读取频率"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入读取频率"},model:{value:e.properties.period,callback:function(t){e.$set(e.properties,"period",t)},expression:"properties.period"}})],1)],1):e._e(),t("a-col",{attrs:{span:24}},[t("opc-points-model",{ref:"OpcPointsModel"})],1)],1)],1)},pe=[],ue=function(){var e=this,t=e._self._c;return t("a-form-model-item",{attrs:{label:"读取点位",prop:"paramContent"}},[t("div",{staticStyle:{"margin-top":"-30px",width:"100%","text-align":"right",height:"30px",color:"#000000","padding-top":"4px"}},[t("a",{on:{click:e.newItem}},[e._v("添加")])]),t("a-table",{staticStyle:{border:"1px #e8e3e3 solid"},attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"small"},scopedSlots:e._u([e._l(["namespace","tag"],(function(r,a){return{key:r,fn:function(o,i){return[i.editable?t("a-input",{key:r,staticStyle:{margin:"-5px 0"},attrs:{value:o,placeholder:e.columns[a].title},on:{change:function(t){return e.handleChange(t.target.value,i.key,r)}}}):[e._v(e._s(o))]]}}})),{key:"action",fn:function(r,a){return[a.editable?[a.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(a.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(a.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此点位？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},de=[],me={name:"OpcPointsModel",data:function(){return{loading:!1,data:[],columns:[{title:"命名空间",dataIndex:"namespace",key:"namespace",width:"40%",scopedSlots:{customRender:"namespace"}},{title:"标识",dataIndex:"tag",key:"tag",width:"40%",scopedSlots:{customRender:"tag"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}]}},methods:{set:function(e){if(this.data=[],e){var t,r=1,a=Object(A["a"])(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;this.data.push({key:r++,namespace:o.namespace,tag:o.tag,editable:!1,isNew:!1})}}catch(i){a.e(i)}finally{a.f()}}},get:function(){var e,t=[],r=Object(A["a"])(this.data);try{for(r.s();!(e=r.n()).done;){var a=e.value;t.push({namespace:a.namespace,tag:a.tag})}}catch(o){r.e(o)}finally{r.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),namespace:0,tag:"",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e}))},saveRow:function(e){this.loading=!0;var t=e.key,r=e.namespace,a=e.tag;if(!r||!a)return this.loading=!1,void this.$message.error("填写不完整");var o=this.data.find((function(e){return e.key===t}));o.editable=!1,o.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(Q["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,r){var a=Object(H["a"])(this.data),o=a.find((function(e){return t===e.key}));o&&(o[r]=e,this.data=a)}}},fe=me,he=Object(f["a"])(fe,ue,de,!1,null,null,null),ve=he.exports,ye={components:{OpcPointsModel:ve},data:function(){return{properties:{points:[]},timeUnitList:w["a"]}},props:{type:{type:String,default:void 0}},mounted:function(){},methods:{set:function(e){var t=this;this.properties=Object.assign({},this.properties,e),this.$nextTick((function(){t.$refs.OpcPointsModel.set(t.properties.points)}))},get:function(){return this.properties.points=this.$refs.OpcPointsModel.get(),this.properties}}},be=ye,ge=Object(f["a"])(be,ce,pe,!1,null,null,null),_e=ge.exports,ke={name:"ResourceModel",components:{MqttProperties:v,KafkaProperties:S,MysqlProperties:L,PostgresqlProperties:N,HttpProperties:Y,TDengineProperties:re,SqlserverProperties:le,OpcUAProperties:_e},data:function(){return{title:"操作",visible:!1,confirmLoading:!1,modal:{},url:{resourceList:"/api/resource/list"},rules:{resourceType:[{required:!0,message:"请选择资源类型",trigger:"blur"}],resourceId:[{required:!0,message:"请选择资源",trigger:"blur"}]},resourceList:[],resourceTypeList:[],resourceMode:null,resourceIndex:-1}},mounted:function(){},methods:{add:function(e){this.edit(e,{},-1)},edit:function(e,t,r){var a=this;this.resourceMode=e,this.resourceIndex=r,this.modal=JSON.parse(JSON.stringify(t)),this.resourceTypeList=Object(l["b"])(e),this.visible=!0,this.$nextTick((function(){a.modal.resourceType&&(a.$refs.PropertiesModal.set(a.modal.properties),a.listResource(a.modal.resourceType))}))},listResource:function(e){var t=this;Object(i["b"])(this.url.resourceList,{resourceType:e}).then((function(e){t.resourceList=e.data}))},onClose:function(){this.visible=!1},handleOk:function(){var e=this,t=this;this.$refs.ruleForm.validate((function(r){r&&(t.confirmLoading=!0,t.modal.properties=t.$refs.PropertiesModal.get(),e.resourceIndex>=0?t.$emit("update",e.resourceMode,e.modal,e.resourceIndex):t.$emit("add",e.resourceMode,e.modal),t.confirmLoading=!1,t.visible=!1)}))},filterOption:function(e,t){return!!t.componentOptions.children[0].text&&t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},resourceTypeChange:function(e){this.modal={resourceType:e},this.listResource(e)},resourceChange:function(e){var t=this,r=this.resourceList.findIndex((function(t){return t.resourceId===e}));this.modal=this.resourceList[r],this.$nextTick((function(){t.modal.resourceType&&t.$refs.PropertiesModal.set(t.modal.properties)}))}}},Se=ke,xe=Object(f["a"])(Se,n,s,!1,null,"85f2395c",null),Me=xe.exports,we=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{confirmLoading:e.confirmLoading,title:"脚本",width:700,visible:e.visible,footer:null,bodyStyle:{padding:0}},on:{cancel:e.onClose}},[t("div",{staticStyle:{"min-height":"400px"}},[t("a-table",{attrs:{columns:e.columns,"data-source":e.scriptList,size:"small",pagination:!1},scopedSlots:e._u([{key:"action",fn:function(r,a){return t("span",{},[t("a",{on:{click:function(t){return e.select(a)}}},[e._v("选择")])])}}])})],1)])},Te=[],$e={name:"ScriptSelectModel",components:{},data:function(){return{visible:!1,confirmLoading:!1,url:{script:"/api/script/list"},columns:[{title:"名称",align:"center",dataIndex:"scriptName",width:"40%"},{title:"最后修改",align:"center",dataIndex:"updateTime",width:"40%"},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],scriptList:[]}},methods:{show:function(){this.getScriptList(),this.visible=!0},onClose:function(){this.visible=!1},getScriptList:function(){var e=this;Object(i["b"])(this.url.script,{}).then((function(t){200===t.code&&(e.scriptList=t.data)}))},select:function(e){this.$emit("select",e),this.visible=!1}}},Oe=$e,Le=Object(f["a"])(Oe,we,Te,!1,null,"7c3ccf4d",null),Re=Le.exports,Ee=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{"body-style":{minHeight:"260px"},bordered:!1}},[t("a-row",{staticStyle:{padding:"0"}},[t("a-col",{staticClass:"title",attrs:{span:12}},[e._v("环境变量")]),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[t("a",{on:{click:e.newItem}},[e._v("添加")])])],1),t("a-table",{attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.loading,size:"middle"},scopedSlots:e._u([e._l(["name","value"],(function(r,a){return{key:r,fn:function(o,i){return[i.editable?t("a-input",{key:r,staticStyle:{margin:"-5px 0"},attrs:{value:o,placeholder:e.columns[a].title},on:{change:function(t){return e.handleChange(t.target.value,i.key,r)}}}):[e._v(e._s(o))]]}}})),{key:"action",fn:function(r,a){return[a.editable?[a.isNew?t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("确定")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此变量？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1):t("span",[t("a",{on:{click:function(t){return e.saveRow(a)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a",{on:{click:function(t){return e.cancel(a.key)}}},[e._v("取消")])],1)]:t("span",[t("a",{on:{click:function(t){return e.toggle(a.key)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"删除此变量？"},on:{confirm:function(t){return e.remove(a.key)}}},[t("a",[e._v("删除")])])],1)]}}],null,!0)})],1)},Ue=[],Ie={name:"VariablesModel",data:function(){return{loading:!1,data:[],columns:[{title:"变量名",dataIndex:"name",key:"name",width:"40%",scopedSlots:{customRender:"name"}},{title:"初始值",dataIndex:"value",key:"value",width:"40%",scopedSlots:{customRender:"value"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}]}},methods:{set:function(e){if(this.data=[],e)for(var t=Object.keys(e),r=1,a=0,o=t;a<o.length;a++){var i=o[a];this.data.push({key:r++,name:i,value:e[i],editable:!1,isNew:!1})}},get:function(){var e,t={},r=Object(A["a"])(this.data);try{for(r.s();!(e=r.n()).done;){var a=e.value;t[a.name]=a.value}}catch(o){r.e(o)}finally{r.f()}return t},newItem:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),name:"",value:"",editable:!0,isNew:!0})},remove:function(e){this.data=this.data.filter((function(t){return t.key!==e}))},saveRow:function(e){this.loading=!0;var t=e.key,r=e.name,a=e.value;if(!r||!a)return this.loading=!1,void this.$message.error("填写不完整");var o=this.data.find((function(e){return e.key===t}));o.editable=!1,o.isNew=!1,this.loading=!1},toggle:function(e){var t=this.data.find((function(t){return t.key===e}));t._originalData=Object(Q["a"])({},t),t.editable=!t.editable},cancel:function(e){var t=this.data.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0},handleChange:function(e,t,r){var a=Object(H["a"])(this.data),o=a.find((function(e){return t===e.key}));o&&(o[r]=e,this.data=a)}}},je=Ie,Ne=(r("b12c"),Object(f["a"])(je,Ee,Ue,!1,null,null,null)),Ce=Ne.exports,De=r("8e45"),Pe={components:{ResourceModel:Me,ScriptSelectModel:Re,VariablesModel:Ce,MonacoEditor:u["a"]},data:function(){return{modal:{sourceResource:null,destResourceList:[],analysisMode:"WITHOUT",ignoreNullValue:!1},url:{add:"/api/rule/add",update:"/api/rule/update",info:"/api/rule/info"},rules:{ruleName:[{required:!0,message:"请输入规则名称",trigger:"blur"}],analysisMode:[{required:!0,message:"请选择解析方式",trigger:"blur"}],ignoreNullValue:[{required:!0,message:"请选择是否忽略空值",trigger:"blur"}]},resourceTypeMap:l["c"],options:{mode:{name:"text/javascript",json:!0},height:150,lineNumbers:!0,tabSize:2,theme:"base16-light",line:!0,autoCloseTags:!0,lineWrapping:!0,styleActiveLine:!0,extraKeys:{tab:"autocomplete"},hintOptions:{tables:{}}},analysisModeList:De["a"],defaultScript:"/**\n* 方法名transform不可修改,入参：data Object 源数据,出参：data Object 目标数据\n*/\nfunction transform(data) {\n    return data;\n}"}},mounted:function(){var e=this,t=this.$route.params.ruleId;"new"!==t&&(this.ruleId=t,Object(i["a"])(this.url.info,{ruleId:this.ruleId}).then((function(t){var r=t.data;r&&(e.modal=t.data,e.$nextTick((function(){e.$refs.VariablesModel.set(e.modal.variables),"script"===e.modal.analysisMode&&e.$refs.MonacoEditor.set(e.modal.script)})))})))},methods:{getDetails:function(e){return Object(l["a"])(e,"rule")},addResource:function(e){this.$refs.ResourceModel.add(e)},editResource:function(e,t,r){this.$refs.ResourceModel.edit(e,t,r)},deleteResource:function(e,t){"dest"===e?this.modal.destResourceList.splice(t,1):"source"===e&&(this.modal.sourceResource=null)},handleAddResource:function(e,t){"dest"===e?this.modal.destResourceList.push(t):"source"===e&&(this.modal.sourceResource=t)},handleUpdateResource:function(e,t,r){"dest"===e?this.$set(this.modal.destResourceList,r,t):"source"===e&&(this.modal.sourceResource=t)},analysisModeChange:function(e){var t=this;"SCRIPT"!==e||this.modal.script?this.modal.script="":this.modal.script=this.defaultScript,this.$nextTick((function(){t.$refs.MonacoEditor.set(t.modal.script)}))},saveRule:function(){var e=this,t=this;this.$refs.ruleForm.validate((function(r){if(!r)return!1;t.confirmLoading=!0;var a,o=JSON.parse(JSON.stringify(e.modal));o.variables=e.$refs.VariablesModel.get(),"script"===e.modal.analysisMode?o.script=e.$refs.MonacoEditor.get():delete o.script,a=e.ruleId?Object(i["c"])(e.url.update,o):Object(i["b"])(e.url.add,o),a.then((function(e){200===e.code?(t.$message.success("保存成功"),t.onClose()):t.$message.error("保存失败")})).finally((function(){t.confirmLoading=!1,t.onClose()}))}))},selectScript:function(){this.$refs.ScriptSelectModel.show()},handleSelectedScript:function(e){this.modal.script=e.scriptContent,this.$refs.MonacoEditor.set(this.modal.script)},onClose:function(){this.$router.push({name:"ruleList"})}}},qe=Pe,He=(r("d7cd"),Object(f["a"])(qe,a,o,!1,null,null,null));t["default"]=He.exports},d7cd:function(e,t,r){"use strict";r("12cc")},ff34:function(e,t,r){}}]);